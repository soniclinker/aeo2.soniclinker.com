(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[2305],{36860:(e,t,n)=>{"use strict";n.d(t,{Ay:()=>D,vU:()=>v});var a=n(37876),r=n(15451),s=n(14232),i=n(38412),l=n(7972),o=n(7e3),c=n(71547),d=n(53970),u=n(23618),m=n(12171),f=n(37096),x=n(35324),h=n(98275),p=n(70505);let y=()=>{let e=new Date,t=new Date(e);t.setDate(e.getDate()-7),t.setHours(0,0,0,0);let n=new Date(e);return n.setHours(23,59,59,999),{startDate:t.getTime(),endDate:n.getTime(),key:"selection"}},v=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"date_range",t=sessionStorage.getItem(e);if(!t)return null;let n=JSON.parse(t);return n.type&&"custom"!==n.type?{...j(n.type),key:"selection"}:"custom"===n.type&&n.startDate&&n.endDate?{startDate:n.startDate,endDate:n.endDate,key:"selection"}:null},b=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"date_range";if(e.startDate&&e.endDate){let n=g(e.startDate,e.endDate);if("custom"!==n)return sessionStorage.setItem(t,JSON.stringify({type:n,key:"selection"})),{...j(n),key:"selection"};{let n=new Date(e.startDate);n.setHours(0,0,0,0);let a=new Date(e.endDate);a.setHours(23,59,59,999);let r={type:"custom",startDate:n.getTime(),endDate:a.getTime(),key:"selection"};return sessionStorage.setItem(t,JSON.stringify(r)),r}}return null},g=(e,t)=>{let n=new Date;if((0,o.o)(e).getTime()===(0,o.o)(n).getTime()&&(0,c.D)(t).getTime()===(0,c.D)(n).getTime())return"today";let a=(0,d.e)(n,1);if((0,o.o)(e).getTime()===(0,o.o)(a).getTime()&&(0,c.D)(t).getTime()===(0,c.D)(a).getTime())return"yesterday";if((0,u.k)(e).getTime()===(0,u.k)(n).getTime()&&(0,c.D)(t).getTime()===(0,m.$)(n).getTime())return"this_week";let r=(0,u.k)((0,f.k)(n,1)),s=(0,m.$)((0,f.k)(n,1));if((0,o.o)(e).getTime()===(0,o.o)(r).getTime()&&(0,c.D)(t).getTime()===(0,c.D)(s).getTime())return"last_week";if((0,x.w)(e).getTime()===(0,x.w)(n).getTime()&&(0,c.D)(t).getTime()===(0,h.p)(n).getTime())return"this_month";let i=(0,x.w)((0,p.a)(n,1)),l=(0,h.p)((0,p.a)(n,1));return(0,o.o)(e).getTime()===(0,o.o)(i).getTime()&&(0,c.D)(t).getTime()===(0,c.D)(l).getTime()?"last_month":"custom"};function j(e){let t,n;let a=new Date;switch(e){case"today":(t=new Date(a)).setHours(0,0,0,0),(n=new Date(a)).setHours(23,59,59,999);break;case"last_week":(t=new Date(a)).setDate(a.getDate()-7),t.setHours(0,0,0,0),(n=new Date(a)).setHours(23,59,59,999);break;case"last_month":t=new Date(a.getFullYear(),a.getMonth()-1,1),n=new Date(a.getFullYear(),a.getMonth(),0,23,59,59,999);break;case"this_week":(t=new Date(a)).setDate(a.getDate()-a.getDay()),t.setHours(0,0,0,0),(n=new Date(a)).setHours(23,59,59,999);break;case"this_month":t=new Date(a.getFullYear(),a.getMonth(),1),(n=new Date(a)).setHours(23,59,59,999);break;case"yesterday":(t=new Date(a)).setDate(a.getDate()-1),t.setHours(0,0,0,0),(n=new Date(a)).setDate(a.getDate()-1),n.setHours(23,59,59,999);break;default:t=new Date(a),n=new Date(a)}return{startDate:t.getTime(),endDate:n.getTime()}}let w=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"dd MMM, yyyy";return"".concat((0,r.GP)(e.startDate,t)," â€“ ").concat((0,r.GP)(e.endDate,t))},D=e=>{let{value:t,onChange:n,handleDateRangeSelection:r,storageKey:o="date_range",dateFormat:c="dd MMM, yyyy",minDate:d,maxDate:u=new Date}=e,m=void 0!==t&&"function"==typeof n,[f,x]=(0,s.useState)(v(o)||y()),[h,p]=(0,s.useState)(!1),g=(0,s.useRef)(null),j=m?t:f,D=m?n:x,N=(0,s.useMemo)(()=>w(j,c),[j,c]),k=(0,s.useMemo)(()=>[{...j,startDate:new Date(j.startDate),endDate:new Date(j.endDate)}],[j]);return(0,s.useEffect)(()=>{r&&r(j)},[j]),(0,s.useEffect)(()=>{if(h)return document.addEventListener("mousedown",e),()=>{document.removeEventListener("mousedown",e)};function e(e){g.current&&!g.current.contains(e.target)&&p(!1)}},[h]),(0,a.jsx)("div",{className:"flex items-center gap-2",children:(0,a.jsxs)("div",{className:"relative",ref:g,children:[(0,a.jsx)("div",{className:"flex gap-2",children:(0,a.jsxs)("button",{className:"flex items-center border border-gray-300 rounded-lg px-3 py-2 text-xs bg-white",onClick:()=>p(e=>!e),"aria-haspopup":"dialog","aria-expanded":h,"aria-label":"Select date range",type:"button",children:[(0,a.jsx)("span",{className:"mr-2",children:N}),(0,a.jsx)(l.fK4,{className:"text-base"})]})}),h&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("div",{className:"fixed inset-0 z-10",onClick:()=>p(!1),style:{background:"transparent"}}),(0,a.jsx)("div",{className:"absolute right-0 z-20 bg-white shadow-lg mt-2",role:"dialog","aria-modal":"true",children:(0,a.jsx)(i.Ur,{editableDateInputs:!0,onChange:e=>{let t=b(e.selection,o);t&&D(t)},moveRangeOnFirstSelection:!1,ranges:k,direction:"horizontal",minDate:d,maxDate:u})})]})]})})}},70753:(e,t,n)=>{(window.__NEXT_P=window.__NEXT_P||[]).push(["/aeo/overview",function(){return n(88786)}])},88786:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>ei});var a=n(37876),r=n(74562),s=n(65259),i=n(43598),l=n(15451),o=n(89099),c=n(14232);n(16691),n(58198);var d=n(75683),u=n(21976),m=n(94344),f=n(68869),x=n(49325),h=n(94499),p=n(65748),y=n(7623),v=n(19926),b=n(69241),g=n(77340),j=n(19850),w=n.n(j),D=n(20624),N=n.n(D),k=n(19809),A=n.n(k),O=n(20527),E=n.n(O),S=n(41946),P=n.n(S),_=n(69067),T=n(9533),M=n(55037),L=n(87110),I=n(13646),B=n(92410),C=n(33311),R=n(84841),z=["layout","type","stroke","connectNulls","isRange","ref"],F=["key"];function H(e){return(H="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function V(e,t){if(null==e)return{};var n,a,r=function(e,t){if(null==e)return{};var n={};for(var a in e)if(Object.prototype.hasOwnProperty.call(e,a)){if(t.indexOf(a)>=0)continue;n[a]=e[a]}return n}(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(a=0;a<s.length;a++)n=s[a],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function W(){return(W=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e}).apply(this,arguments)}function q(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,a)}return n}function J(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?q(Object(n),!0).forEach(function(t){Y(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):q(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function G(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,X(a.key),a)}}function K(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(e){}return(K=function(){return!!e})()}function U(e){return(U=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Q(e,t){return(Q=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function Y(e,t,n){return(t=X(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function X(e){var t=function(e,t){if("object"!=H(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var a=n.call(e,t||"default");if("object"!=H(a))return a;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==H(t)?t:t+""}var $=function(e){var t,n;function a(){!function(e,t){if(!(e instanceof t))throw TypeError("Cannot call a class as a function")}(this,a);for(var e,t,n,r=arguments.length,s=Array(r),i=0;i<r;i++)s[i]=arguments[i];return t=a,n=[].concat(s),t=U(t),Y(e=function(e,t){if(t&&("object"===H(t)||"function"==typeof t))return t;if(void 0!==t)throw TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(this,K()?Reflect.construct(t,n||[],U(this).constructor):t.apply(this,n)),"state",{isAnimationFinished:!0}),Y(e,"id",(0,B.NF)("recharts-area-")),Y(e,"handleAnimationEnd",function(){var t=e.props.onAnimationEnd;e.setState({isAnimationFinished:!0}),w()(t)&&t()}),Y(e,"handleAnimationStart",function(){var t=e.props.onAnimationStart;e.setState({isAnimationFinished:!1}),w()(t)&&t()}),e}return!function(e,t){if("function"!=typeof t&&null!==t)throw TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Q(e,t)}(a,e),t=[{key:"renderDots",value:function(e,t,n){var r=this.props.isAnimationActive,s=this.state.isAnimationFinished;if(r&&!s)return null;var i=this.props,l=i.dot,o=i.points,d=i.dataKey,u=(0,R.J9)(this.props,!1),m=(0,R.J9)(l,!0),f=o.map(function(e,t){var n=J(J(J({key:"dot-".concat(t),r:3},u),m),{},{index:t,cx:e.x,cy:e.y,dataKey:d,value:e.value,payload:e.payload,points:o});return a.renderDotItem(l,n)}),x={clipPath:e?"url(#clipPath-".concat(t?"":"dots-").concat(n,")"):null};return c.createElement(M.W,W({className:"recharts-area-dots"},x),f)}},{key:"renderHorizontalRect",value:function(e){var t=this.props,n=t.baseLine,a=t.points,r=t.strokeWidth,s=a[0].x,i=a[a.length-1].x,l=e*Math.abs(s-i),o=N()(a.map(function(e){return e.y||0}));return((0,B.Et)(n)&&"number"==typeof n?o=Math.max(n,o):n&&Array.isArray(n)&&n.length&&(o=Math.max(N()(n.map(function(e){return e.y||0})),o)),(0,B.Et)(o))?c.createElement("rect",{x:s<i?s:s-l,y:0,width:l,height:Math.floor(o+(r?parseInt("".concat(r),10):1))}):null}},{key:"renderVerticalRect",value:function(e){var t=this.props,n=t.baseLine,a=t.points,r=t.strokeWidth,s=a[0].y,i=a[a.length-1].y,l=e*Math.abs(s-i),o=N()(a.map(function(e){return e.x||0}));return((0,B.Et)(n)&&"number"==typeof n?o=Math.max(n,o):n&&Array.isArray(n)&&n.length&&(o=Math.max(N()(n.map(function(e){return e.x||0})),o)),(0,B.Et)(o))?c.createElement("rect",{x:0,y:s<i?s:s-l,width:o+(r?parseInt("".concat(r),10):1),height:Math.floor(l)}):null}},{key:"renderClipRect",value:function(e){return"vertical"===this.props.layout?this.renderVerticalRect(e):this.renderHorizontalRect(e)}},{key:"renderAreaStatically",value:function(e,t,n,a){var r=this.props,s=r.layout,i=r.type,l=r.stroke,o=r.connectNulls,d=r.isRange,u=(r.ref,V(r,z));return c.createElement(M.W,{clipPath:n?"url(#clipPath-".concat(a,")"):null},c.createElement(_.I,W({},(0,R.J9)(u,!0),{points:e,connectNulls:o,type:i,baseLine:t,layout:s,stroke:"none",className:"recharts-area-area"})),"none"!==l&&c.createElement(_.I,W({},(0,R.J9)(this.props,!1),{className:"recharts-area-curve",layout:s,type:i,connectNulls:o,fill:"none",points:e})),"none"!==l&&d&&c.createElement(_.I,W({},(0,R.J9)(this.props,!1),{className:"recharts-area-curve",layout:s,type:i,connectNulls:o,fill:"none",points:t})))}},{key:"renderAreaWithAnimation",value:function(e,t){var n=this,a=this.props,r=a.points,s=a.baseLine,i=a.isAnimationActive,l=a.animationBegin,o=a.animationDuration,d=a.animationEasing,u=a.animationId,m=this.state,f=m.prevPoints,x=m.prevBaseLine;return c.createElement(g.Ay,{begin:l,duration:o,isActive:i,easing:d,from:{t:0},to:{t:1},key:"area-".concat(u),onAnimationEnd:this.handleAnimationEnd,onAnimationStart:this.handleAnimationStart},function(a){var i=a.t;if(f){var l,o=f.length/r.length,d=r.map(function(e,t){var n=Math.floor(t*o);if(f[n]){var a=f[n],r=(0,B.Dj)(a.x,e.x),s=(0,B.Dj)(a.y,e.y);return J(J({},e),{},{x:r(i),y:s(i)})}return e});return l=(0,B.Et)(s)&&"number"==typeof s?(0,B.Dj)(x,s)(i):A()(s)||E()(s)?(0,B.Dj)(x,0)(i):s.map(function(e,t){var n=Math.floor(t*o);if(x[n]){var a=x[n],r=(0,B.Dj)(a.x,e.x),s=(0,B.Dj)(a.y,e.y);return J(J({},e),{},{x:r(i),y:s(i)})}return e}),n.renderAreaStatically(d,l,e,t)}return c.createElement(M.W,null,c.createElement("defs",null,c.createElement("clipPath",{id:"animationClipPath-".concat(t)},n.renderClipRect(i))),c.createElement(M.W,{clipPath:"url(#animationClipPath-".concat(t,")")},n.renderAreaStatically(r,s,e,t)))})}},{key:"renderArea",value:function(e,t){var n=this.props,a=n.points,r=n.baseLine,s=n.isAnimationActive,i=this.state,l=i.prevPoints,o=i.prevBaseLine,c=i.totalLength;return s&&a&&a.length&&(!l&&c>0||!P()(l,a)||!P()(o,r))?this.renderAreaWithAnimation(e,t):this.renderAreaStatically(a,r,e,t)}},{key:"render",value:function(){var e,t=this.props,n=t.hide,a=t.dot,r=t.points,s=t.className,i=t.top,l=t.left,o=t.xAxis,d=t.yAxis,u=t.width,m=t.height,f=t.isAnimationActive,x=t.id;if(n||!r||!r.length)return null;var h=this.state.isAnimationFinished,p=1===r.length,y=(0,b.A)("recharts-area",s),v=o&&o.allowDataOverflow,g=d&&d.allowDataOverflow,j=v||g,w=A()(x)?this.id:x,D=null!==(e=(0,R.J9)(a,!1))&&void 0!==e?e:{r:3,strokeWidth:2},N=D.r,k=D.strokeWidth,O=((0,R.sT)(a)?a:{}).clipDot,E=void 0===O||O,S=2*(void 0===N?3:N)+(void 0===k?2:k);return c.createElement(M.W,{className:y},v||g?c.createElement("defs",null,c.createElement("clipPath",{id:"clipPath-".concat(w)},c.createElement("rect",{x:v?l:l-u/2,y:g?i:i-m/2,width:v?u:2*u,height:g?m:2*m})),!E&&c.createElement("clipPath",{id:"clipPath-dots-".concat(w)},c.createElement("rect",{x:l-S/2,y:i-S/2,width:u+S,height:m+S}))):null,p?null:this.renderArea(j,w),(a||p)&&this.renderDots(j,E,w),(!f||h)&&L.Z.renderCallByParent(this.props,r))}}],n=[{key:"getDerivedStateFromProps",value:function(e,t){return e.animationId!==t.prevAnimationId?{prevAnimationId:e.animationId,curPoints:e.points,curBaseLine:e.baseLine,prevPoints:t.curPoints,prevBaseLine:t.curBaseLine}:e.points!==t.curPoints||e.baseLine!==t.curBaseLine?{curPoints:e.points,curBaseLine:e.baseLine}:null}}],t&&G(a.prototype,t),n&&G(a,n),Object.defineProperty(a,"prototype",{writable:!1}),a}(c.PureComponent);Y($,"displayName","Area"),Y($,"defaultProps",{stroke:"#3182bd",fill:"#3182bd",fillOpacity:.6,xAxisId:0,yAxisId:0,legendType:"line",connectNulls:!1,points:[],dot:!1,activeDot:!0,hide:!1,isAnimationActive:!I.m.isSsr,animationBegin:0,animationDuration:1500,animationEasing:"ease"}),Y($,"getBaseValue",function(e,t,n,a){var r=e.layout,s=e.baseValue,i=t.props.baseValue,l=null!=i?i:s;if((0,B.Et)(l)&&"number"==typeof l)return l;var o="horizontal"===r?a:n,c=o.scale.domain();if("number"===o.type){var d=Math.max(c[0],c[1]),u=Math.min(c[0],c[1]);return"dataMin"===l?u:"dataMax"===l?d:d<0?d:Math.max(Math.min(c[0],c[1]),0)}return"dataMin"===l?c[0]:"dataMax"===l?c[1]:c[0]}),Y($,"getComposedData",function(e){var t,n=e.props,a=e.item,r=e.xAxis,s=e.yAxis,i=e.xAxisTicks,l=e.yAxisTicks,o=e.bandSize,c=e.dataKey,d=e.stackedData,u=e.dataStartIndex,m=e.displayedData,f=e.offset,x=n.layout,h=d&&d.length,p=$.getBaseValue(n,a,r,s),y="horizontal"===x,v=!1,b=m.map(function(e,t){h?n=d[u+t]:Array.isArray(n=(0,C.kr)(e,c))?v=!0:n=[p,n];var n,a=null==n[1]||h&&null==(0,C.kr)(e,c);return y?{x:(0,C.nb)({axis:r,ticks:i,bandSize:o,entry:e,index:t}),y:a?null:s.scale(n[1]),value:n,payload:e}:{x:a?null:r.scale(n[1]),y:(0,C.nb)({axis:s,ticks:l,bandSize:o,entry:e,index:t}),value:n,payload:e}});return t=h||v?b.map(function(e){var t=Array.isArray(e.value)?e.value[0]:null;return y?{x:e.x,y:null!=t&&null!=e.y?s.scale(t):null}:{x:null!=t?r.scale(t):null,y:e.y}}):y?s.scale(p):r.scale(p),J({points:b,baseLine:t,layout:x,isRange:v},f)}),Y($,"renderDotItem",function(e,t){var n;if(c.isValidElement(e))n=c.cloneElement(e,t);else if(w()(e))n=e(t);else{var a=(0,b.A)("recharts-area-dot","boolean"!=typeof e?e.className:""),r=t.key,s=V(t,F);n=c.createElement(T.c,W({},s,{key:r,className:a}))}return n});var Z=n(92889),ee=n(36860),et=n(6630);let en=new Date,ea=new Date(en);ea.setDate(en.getDate()-7),ea.setHours(0,0,0,0);let er=new Date(en);er.setHours(23,59,59,999);let es={startDate:ea.getTime(),endDate:er.getTime(),key:"selection"},ei=()=>{var e,t,n,l,o,b,g;let[j,w]=(0,c.useState)([]),[D,N]=(0,c.useState)(!1),[k,A]=(0,c.useState)(""),[O,E]=(0,c.useState)(null),[S,P]=(0,c.useState)(null),[_,T]=(0,c.useState)(!1),[M,L]=(0,c.useState)((0,ee.vU)()||es),[I,B]=(0,c.useState)(null),C=(0,c.useRef)(null);(0,m.A)([C],()=>T(!1));let R=async(e,t)=>{var n;if(!e||!t.startDate||!t.endDate)return;let a="/orgs/".concat(null===(n=i.A.current())||void 0===n?void 0:n.id,"/aeoanalysis/tasks?queryset_id=").concat(e);t.startDate&&t.endDate&&(a+="&start_date=".concat(t.startDate,"&end_date=").concat(t.endDate));let{data:r,error:l}=await s.A.doGet({path:a});if(l){P("Failed to fetch runs"),w([]),N(!1);return}return w(r.tasks||[]),r.tasks.length>0&&E(r.tasks[0]),r.tasks.length},z="My Brand";for(let n of(null==I?void 0:null===(t=I.result)||void 0===t?void 0:null===(e=t.info)||void 0===e?void 0:e.args)||[])if("brand"===n.id){z=(n.value||"").trim().split(",")[0].trim();break}let F=j.map(e=>{var t,n,a,r,s,i,l,o,c;return{date:new Date(Number(e.created_at)).toLocaleDateString("en-GB",{day:"2-digit",month:"short"}),value:Number(null!==(l=null===(n=e.data)||void 0===n?void 0:null===(t=n.result)||void 0===t?void 0:t.sov)&&void 0!==l?l:0),runId:e.id,questions:Number(null!==(o=null===(r=e.data)||void 0===r?void 0:null===(a=r.result)||void 0===a?void 0:a.num_questions)&&void 0!==o?o:0),highlight:!1,sov:Number(null!==(c=null===(i=e.data)||void 0===i?void 0:null===(s=i.result)||void 0===s?void 0:s.sov)&&void 0!==c?c:0),createdAt:Number(e.created_at)}});(0,c.useEffect)(()=>{k&&M.startDate&&M.endDate&&R(k,M)},[k,M]),(0,c.useEffect)(()=>{(async()=>{N(!0);let e=await i.A.checkAndGetAeoProject();if(!e)return P("Project not found"),N(!1),r.A.show("Create new project",(0,a.jsx)(et.default,{}),!0,"90%");A(e.id),setTimeout(()=>{R(k,M),N(!1)},0)})()},[]);let H=null==O?void 0:null===(n=O.data)||void 0===n?void 0:n.result;return(0,c.useEffect)(()=>{let e=async()=>{if(!O)return;P(null);let e="/orgs/".concat(i.A.current().id,"/aeoanalysis/tasks/").concat(O.id,"?fetch_result=true"),t=await s.A.doGet({path:e});if(t.error){P("Failed to fetch analysis data"),N(!1);return}B(t.data.task)};O&&e()},[O]),(0,a.jsxs)("div",{className:"px-5 md:px-5 py-5 md:py-7 bg-white min-h-screen fontDmSans",children:[(0,a.jsx)("div",{className:"flex flex-col md:flex-row md:items-center md:justify-between mb-6 gap-3",children:(0,a.jsx)("h2",{className:"text-2xl font-bold text-black",children:"Share Of Voice"})}),(0,a.jsxs)("div",{className:"border-t border-[#E5E7EB] py-5 mb-4",children:[(0,a.jsxs)("div",{className:"flex flex-col md:flex-row md:items-center md:justify-between mb-4 gap-3",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("div",{className:"text-base font-semibold text-[#222] mb-1",children:"Visibility Score"}),(0,a.jsx)("div",{className:"text-xs text-gray-500 mb-2",children:"Percentage of responses mentioning your Brand over the selected date range."})]}),(0,a.jsx)(ee.Ay,{handleDateRangeSelection:e=>R(k,{...e,key:"selection"})})]}),(0,a.jsx)("div",{className:"w-full h-56 relative",children:(0,a.jsx)(f.u,{width:"100%",height:"100%",children:(0,a.jsxs)(x.b,{data:F.reverse(),margin:{top:20,right:40,left:0,bottom:0},children:[(0,a.jsx)("defs",{children:(0,a.jsxs)("linearGradient",{id:"colorUv",x1:"0",y1:"0",x2:"0",y2:"1",children:[(0,a.jsx)("stop",{offset:"0%",stopColor:"#6366f1",stopOpacity:.35}),(0,a.jsx)("stop",{offset:"60%",stopColor:"#6366f1",stopOpacity:.12}),(0,a.jsx)("stop",{offset:"100%",stopColor:"#6366f1",stopOpacity:0})]})}),(0,a.jsx)(h.d,{vertical:!1,strokeDasharray:"3 3",stroke:"#f3f3f3"}),(0,a.jsx)(p.W,{dataKey:"date",axisLine:!1,tickLine:!1,tick:{fontSize:12,fill:"#888"},dy:8}),(0,a.jsx)(y.h,{domain:[0,100],axisLine:!1,tickLine:!1,tick:{fontSize:12,fill:"#888"},dx:-8,ticks:[0,25,50,75,100]}),(0,a.jsx)(v.m,{content:(0,a.jsx)(el,{}),cursor:{stroke:"#6366f1",strokeWidth:1,opacity:.1}}),(0,a.jsx)($,{type:"monotone",dataKey:"value",stroke:"none",fill:"url(#colorUv)"}),(0,a.jsx)(Z.N,{type:"monotone",dataKey:"value",stroke:"#6366f1",strokeWidth:2.5,dot:(0,a.jsx)(eo,{}),activeDot:{r:6}})]})})}),(0,a.jsxs)("div",{className:"text-xs font-normal -mx-2 md:-mx-5 p-5 mt-10 text-gray-600 bg-neutral-200/40 flex flex-col md:flex-row justify-between gap-2",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2",children:["Results For Last Run Completed On",(0,a.jsx)("span",{className:"font-bold text-black",children:O?new Date(Number(O.created_at)).toLocaleString():"-"})]}),(0,a.jsx)("div",{className:"flex items-center gap-3 mt-2 md:mt-0 relative",children:(0,a.jsxs)("div",{ref:C,className:"relative",children:[(0,a.jsxs)("button",{className:"flex items-center gap-2 rounded-lg shadow-[0px_1px_2px_0px_rgba(0,0,0,0.05)] outline-1 outline-offset-[-1px] outline-neutral-200 bg-white px-3 py-2 hover:shadow transition-all",onClick:()=>T(e=>!e),children:[(0,a.jsx)(u.Kt4,{color:"text-neutral-950",size:16}),(0,a.jsx)("span",{className:"text-neutral-950 text-xs font-normal",children:O?null===(l=O.data)||void 0===l?void 0:l.queryset_name:"Run"}),(0,a.jsx)(d.q2p,{className:"text-black text-lg -ml-1",size:16})]}),_&&(0,a.jsx)("div",{className:"absolute right-0 top-12 z-10 bg-white border border-gray-200 rounded shadow w-48 max-h-56 overflow-y-auto",children:j.map(e=>{var t;return(0,a.jsxs)("div",{className:"px-4 py-2 cursor-pointer hover:bg-gray-100 ".concat((null==O?void 0:O.id)===e.id?"bg-gray-100 font-bold":""),onClick:()=>{E(e),T(!1)},children:[(0,a.jsx)("div",{className:"font-medium",children:null===(t=e.data)||void 0===t?void 0:t.queryset_name}),(0,a.jsx)("div",{className:"text-xs text-gray-500",children:new Date(Number(e.created_at)).toLocaleString()})]},e.id)})})]})})]})]}),D&&(0,a.jsx)("div",{className:"text-center py-10",children:"Loading..."}),S&&(0,a.jsx)("div",{className:"text-center text-red-500 py-10",children:S}),!D&&!S&&H&&(0,a.jsx)("div",{className:"bg-white mt-5",children:(0,a.jsxs)("div",{className:"flex flex-col md:grid md:grid-cols-2 gap-8 items-start",children:[(0,a.jsxs)("div",{className:"border-0 md:border-r-[0.8px] border-neutral-200 w-full flex flex-col items-start justify-center md:pr-5 mb-8 md:mb-0",children:[(0,a.jsx)("div",{className:"text-neutral-950 text-base font-semibold mb-9",children:"Share Of Voice"}),(0,a.jsx)("div",{className:"grid grid-cols-1 gap-4",children:(0,a.jsxs)("div",{className:"grid grid-cols-2 md:grid-cols-2 gap-4",children:[(0,a.jsxs)("div",{className:"bg-primary rounded-lg py-4 px-3 flex flex-col justify-center min-h-[80px]",children:[(0,a.jsxs)("div",{className:"flex items-center mb-2",children:[(0,a.jsx)("div",{className:"w-1 h-4 bg-indigo-400 rounded-2xl mr-2"}),(0,a.jsx)("span",{className:"textPrimary500 text-xs font-medium",children:"Total Questions Run"})]}),(0,a.jsx)("div",{className:" text-zinc-900 text-base font-semibold",children:null!==(o=null==H?void 0:H.num_questions)&&void 0!==o?o:"-"})]}),(0,a.jsxs)("div",{className:"bg-primary rounded-lg p-6 flex flex-col justify-center min-h-[80px]",children:[(0,a.jsxs)("div",{className:"flex items-center mb-2",children:[(0,a.jsx)("div",{className:"w-1 h-4 bg-indigo-400 rounded-2xl mr-2"}),(0,a.jsx)("span",{className:"textPrimary500 text-xs font-medium ",children:"My SOV (Brand Mentions)"})]}),(0,a.jsx)("div",{className:" text-zinc-900 text-base font-semibold",children:(null==H?void 0:H.sov)!==void 0?"".concat(Number(H.sov).toFixed(2),"%"):"-"})]}),(0,a.jsxs)("div",{className:"bg-primary rounded-lg p-6 flex flex-col justify-center min-h-[80px]",children:[(0,a.jsxs)("div",{className:"flex items-center mb-2",children:[(0,a.jsx)("div",{className:"w-1 h-4 bg-indigo-400 rounded-2xl mr-2"}),(0,a.jsx)("span",{className:"textPrimary500 text-xs font-medium ",children:"All Brand Mentions"})]}),(0,a.jsx)("div",{className:" text-zinc-900 text-base font-semibold",children:null!==(b=null==H?void 0:H.num_brands)&&void 0!==b?b:"-"})]}),(0,a.jsxs)("div",{className:"bg-primary rounded-lg p-6 flex flex-col justify-center min-h-[80px]",children:[(0,a.jsxs)("div",{className:"flex items-center mb-2",children:[(0,a.jsx)("div",{className:"w-1 h-4 bg-indigo-400 rounded-2xl mr-2"}),(0,a.jsx)("span",{className:"textPrimary500 text-xs font-medium ",children:"Citations"})]}),(0,a.jsx)("div",{className:" text-zinc-900 text-base font-semibold",children:null!==(g=null==H?void 0:H.num_sources)&&void 0!==g?g:"-"})]})]})})]}),(0,a.jsxs)("div",{className:"border-0 md:border-r-[0.8px] border-neutral-200 pr-0 md:pr-5 mb-8 md:mb-0 w-full overflow-x-auto",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,a.jsx)("div",{className:"text-neutral-950 text-base font-semibold",children:"Brand Visibility Index"}),(0,a.jsx)("button",{className:"text-black text-xs font-normal",children:"View more"})]}),(0,a.jsx)("div",{className:"text-zinc-700 text-xs font-normal mb-5 md:mb-2",children:"Top 10 brands ranked by SOV"}),(0,a.jsx)("div",{className:"w-full overflow-x-auto max-h-[320px] overflow-y-auto scrollbar-hide",children:(0,a.jsxs)("table",{className:"w-full text-xs min-w-[340px]",children:[(0,a.jsx)("thead",{children:(0,a.jsxs)("tr",{className:"text-gray-400",children:[(0,a.jsx)("th",{className:"text-left text-slate-500 text-xs font-normal"}),(0,a.jsx)("th",{className:"text-left text-slate-500 text-xs font-normal",children:"Brands"}),(0,a.jsx)("th",{className:"text-left text-slate-500 text-xs font-normal",children:"SOV"}),(0,a.jsx)("th",{className:"text-left text-slate-500 text-xs font-normal",children:"Questions"})]})}),(0,a.jsx)("tbody",{children:(()=>{var e,t;let n=(null==I?void 0:null===(e=I.result)||void 0===e?void 0:e.others)||[],r=(null==I?void 0:null===(t=I.result)||void 0===t?void 0:t.own)?{name:I.result.own.name||z,sov:I.result.own.sov,mentions:Array.isArray(I.result.own.queries)?I.result.own.queries.length:I.result.own.mentions||0}:null;return[...n.map(e=>({name:e.name,sov:e.sov,mentions:Array.isArray(e.queries)?e.queries.length:e.mentions||0}))||[],...r?[r]:[]].sort((e,t)=>(t.sov||0)-(e.sov||0)).slice(0,50).map((e,t)=>{var n;return(0,a.jsxs)("tr",{className:"text-[#222] font-medium",children:[(0,a.jsx)("td",{children:t+1}),(0,a.jsxs)("td",{className:"py-1",children:[" ",e.name]}),(0,a.jsx)("td",{className:"py-1 font-bold",children:void 0!==e.sov?"".concat(Number(e.sov).toFixed(2),"%"):"-"}),(0,a.jsx)("td",{className:"py-1",children:null!==(n=e.mentions)&&void 0!==n?n:"-"})]},e.name)})})()})]})})]})]})})]})},el=e=>{let{active:t,payload:n,label:r}=e,s=(0,o.useRouter)();if(t&&n&&n.length){let e=n[0].payload,t=(0,l.GP)(new Date(e.createdAt),"MMM dd, yyyy, hh:mm:ss a");return(0,a.jsxs)("div",{className:"bg-white border border-gray-200 rounded-lg p-3 shadow text-xs min-w-[140px]",style:{pointerEvents:"auto"},children:[(0,a.jsx)("div",{className:"mb-1 text-black font-semibold",children:t}),(0,a.jsxs)("div",{className:"flex items-center justify-between mb-1 text-black font-medium",children:[(0,a.jsx)("span",{children:"SOV"}),(0,a.jsxs)("span",{className:"font-bold text-green-600",children:[e.sov.toFixed(2),"%"]})]}),(0,a.jsxs)("div",{className:"flex items-center justify-between mb-1 text-black font-medium",children:[(0,a.jsx)("span",{children:"Run ID:"}),(0,a.jsx)("span",{children:e.runId})]}),(0,a.jsxs)("div",{className:"flex items-center justify-between mb-1 text-black font-medium",children:[(0,a.jsx)("span",{children:"Questions:"}),(0,a.jsx)("span",{children:e.questions})]}),(0,a.jsx)("button",{className:"text-blue-600 underline text-xs mt-2 block",type:"button",onClick:()=>s.push("/aeo/history/questions?runId=".concat(e.runId)),children:"View Questions"})]})}return null},eo=e=>{let{cx:t,cy:n}=e;return(0,a.jsx)("circle",{cx:t,cy:n,r:6,fill:"#6366f1",stroke:"#fff",strokeWidth:2})}},94344:(e,t,n)=>{"use strict";n.d(t,{A:()=>r});var a=n(14232);let r=(e,t)=>{(0,a.useEffect)(()=>{let n=n=>{!e.some(e=>e.current&&e.current.contains(n.target))&&t(n)};return document.addEventListener("mousedown",n),()=>document.removeEventListener("mousedown",n)},[e,t])}}},e=>{var t=t=>e(e.s=t);e.O(0,[5711,7141,9034,7092,1153,6343,4249,636,6593,8792],()=>t(70753)),_N_E=e.O()}]);