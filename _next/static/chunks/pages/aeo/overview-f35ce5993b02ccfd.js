(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[2305],{53435:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>g});var l=s(37876),n=s(14232),a=s(68869),i=s(49325),r=s(94499),d=s(65748),o=s(7623),c=s(19926),x=s(23518),m=s(92889),u=s(65259),h=s(43598),v=s(21976),f=s(75683),j=s(74562),b=s(6630),p=s(89099),y=s(38412);s(16691),s(58198);var N=s(83350);let g=()=>{var e,t,s,g,w,k,D,_,S,A,E,q,z,C,O,M,P,V,L;let[B,G]=(0,n.useState)([]),[R,F]=(0,n.useState)(null),[I,T]=(0,n.useState)(null),[K,Q]=(0,n.useState)(!1),[W,H]=(0,n.useState)(null),[U,X]=(0,n.useState)(!1),[Y,J]=(0,n.useState)([]),Z=(0,p.useRouter)(),[$,ee]=(0,n.useState)([{startDate:new Date,endDate:new Date,key:"selection"}]),[et,es]=(0,n.useState)(!1),el=(0,n.useRef)(null),en="".concat((0,N.GP)($[0].startDate,"MMM dd, yyyy")," â€“ ").concat((0,N.GP)($[0].endDate,"MMM dd, yyyy"));(0,n.useEffect)(()=>{(async()=>{Q(!0),H(null);let e=await h.A.checkAndGetAeoProject();if(!e)return H("Project not found"),j.A.show("Create new project",(0,l.jsx)(b.default,{}),!0,"90%");let t="/orgs/".concat(h.A.current().id,"/aeoanalysis/tasks?queryset_id=").concat(e.id),{data:s,error:n}=await u.A.doGet({path:t});if(n){H("Failed to fetch query sets"),Q(!1);return}G(s.tasks||[]),s.tasks&&s.tasks.length>0&&F(s.tasks[0]),Q(!1)})()},[]),(0,n.useEffect)(()=>{(async()=>{B.length&&(Q(!0),J((await Promise.all(B.map(async e=>{var t,s,l,n,a,i,r,d;let o="/orgs/".concat(h.A.current().id,"/aeoanalysis/tasks/").concat(e.id,"?fetch_result=true"),c=await u.A.doGet({path:o});if(c.error)return null;let x=null===(t=c.data.task)||void 0===t?void 0:t.result;return{date:new Date(Number(e.created_at)).toLocaleDateString("en-GB",{day:"2-digit",month:"short"}),value:Number(null!==(i=null==x?void 0:null===(s=x.own)||void 0===s?void 0:s.sov)&&void 0!==i?i:0),runId:e.id,questions:Number(null!==(r=null==x?void 0:null===(n=x.all)||void 0===n?void 0:null===(l=n.queries)||void 0===l?void 0:l.length)&&void 0!==r?r:0),highlight:!1,sov:Number(null!==(d=null==x?void 0:null===(a=x.own)||void 0===a?void 0:a.sov)&&void 0!==d?d:0),createdAt:Number(e.created_at)}}))).filter(e=>null!==e)),Q(!1))})()},[B]),(0,n.useEffect)(()=>{let e=async()=>{if(!R)return;Q(!0),H(null);let e="/orgs/".concat(h.A.current().id,"/aeoanalysis/tasks/").concat(R.id,"?fetch_result=true"),t=await u.A.doGet({path:e});if(t.error){H("Failed to fetch analysis data"),Q(!1);return}T(t.data.task),Q(!1)};R&&e()},[R]),(0,n.useEffect)(()=>{if(et)return document.addEventListener("mousedown",e),()=>{document.removeEventListener("mousedown",e)};function e(e){el.current&&!el.current.contains(e.target)&&es(!1)}},[et]);let ea="My Brand";for(let s of(null==I?void 0:null===(t=I.result)||void 0===t?void 0:null===(e=t.info)||void 0===e?void 0:e.args)||[])if("brand"===s.id){ea=(s.value||"").trim().split(",")[0].trim();break}let ei=$[0].startDate,er=$[0].endDate,ed=Y.filter(e=>{let t;(t=new Date(/\d{2} \w{3}/.test(e.date)?"".concat(e.date," ").concat(new Date().getFullYear()):e.date)).setHours(0,0,0,0);let s=new Date(ei);s.setHours(0,0,0,0);let l=new Date(er);return l.setHours(0,0,0,0),t>=s&&t<=l});return(0,l.jsxs)("div",{className:"px-5 py-7 bg-white min-h-screen fontDmSans",children:[(0,l.jsx)("div",{className:"flex items-center justify-between mb-6",children:(0,l.jsx)("h2",{className:"text-2xl font-bold text-black",children:"Share Of Voice"})}),(0,l.jsxs)("div",{className:" border-t border-[#E5E7EB] py-5 mb-4",children:[(0,l.jsxs)("div",{className:"flex flex-col md:flex-row md:items-center md:justify-between mb-4",children:[(0,l.jsxs)("div",{children:[(0,l.jsx)("div",{className:"text-base font-semibold text-[#222] mb-1",children:"Visibility Score"}),(0,l.jsx)("div",{className:"text-xs text-gray-500 mb-2",children:"Percentage of responses mentioning your Brand over the selected date range."})]}),(0,l.jsx)("div",{className:"flex items-center gap-2 mt-2 md:mt-0",children:(0,l.jsxs)("div",{className:"relative",children:[(0,l.jsx)("button",{className:"flex items-center border border-gray-300 rounded px-3 py-2 text-xs bg-white",onClick:()=>es(e=>!e),children:(0,l.jsx)("span",{className:"mr-2",children:en})}),et&&(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)("div",{className:"fixed inset-0 z-10",onClick:()=>es(!1),style:{background:"transparent"}}),(0,l.jsx)("div",{className:"absolute right-0 z-20 bg-white shadow-lg mt-2",children:(0,l.jsx)(y.ad,{editableDateInputs:!0,onChange:e=>{let t=e.selection;ee([{startDate:t.startDate?new Date(t.startDate):new Date,endDate:t.endDate?new Date(t.endDate):new Date,key:"selection"}])},moveRangeOnFirstSelection:!1,ranges:$,maxDate:new Date})})]})]})})]}),(0,l.jsx)("div",{className:"w-full h-56 relative",children:(0,l.jsx)(a.u,{width:"100%",height:"100%",children:(0,l.jsxs)(i.b,{data:ed,margin:{top:20,right:40,left:0,bottom:0},children:[(0,l.jsx)("defs",{children:(0,l.jsxs)("linearGradient",{id:"colorUv",x1:"0",y1:"0",x2:"0",y2:"1",children:[(0,l.jsx)("stop",{offset:"0%",stopColor:"#6366f1",stopOpacity:.35}),(0,l.jsx)("stop",{offset:"60%",stopColor:"#6366f1",stopOpacity:.12}),(0,l.jsx)("stop",{offset:"100%",stopColor:"#6366f1",stopOpacity:0})]})}),(0,l.jsx)(r.d,{vertical:!1,strokeDasharray:"3 3",stroke:"#f3f3f3"}),(0,l.jsx)(d.W,{dataKey:"date",axisLine:!1,tickLine:!1,tick:{fontSize:12,fill:"#888"},dy:8}),(0,l.jsx)(o.h,{domain:[0,100],axisLine:!1,tickLine:!1,tick:{fontSize:12,fill:"#888"},dx:-8,ticks:[0,25,50,75,100]}),(0,l.jsx)(c.m,{content:(0,l.jsx)(e=>{let{active:t,payload:s,label:n}=e;if(t&&s&&s.length){let e=s[0].payload,t=(0,N.GP)(new Date(e.createdAt),"MMM dd, yyyy, hh:mm:ss a");return(0,l.jsxs)("div",{className:"bg-white border border-gray-200 rounded-lg p-3 shadow text-xs min-w-[140px]",style:{pointerEvents:"auto"},children:[(0,l.jsx)("div",{className:"mb-1 text-black font-semibold",children:t}),(0,l.jsxs)("div",{className:"flex items-center justify-between mb-1 text-black font-medium",children:[(0,l.jsx)("span",{children:"SOV"}),(0,l.jsxs)("span",{className:"font-bold text-green-600",children:[e.sov,"%"]})]}),(0,l.jsxs)("div",{className:"flex items-center justify-between mb-1 text-black font-medium",children:[(0,l.jsx)("span",{children:"Run ID:"}),(0,l.jsx)("span",{children:e.runId})]}),(0,l.jsxs)("div",{className:"flex items-center justify-between mb-1 text-black font-medium",children:[(0,l.jsx)("span",{children:"Questions:"}),(0,l.jsx)("span",{children:e.questions})]}),(0,l.jsx)("button",{className:"text-blue-600 underline text-xs mt-2 block",type:"button",onClick:()=>Z.push("/aeo/history/questions?runId=".concat(e.runId)),children:"View Questions"})]})}return null},{}),cursor:{stroke:"#6366f1",strokeWidth:1,opacity:.1}}),(0,l.jsx)(x.G,{type:"monotone",dataKey:"value",stroke:"none",fill:"url(#colorUv)"}),(0,l.jsx)(m.N,{type:"monotone",dataKey:"value",stroke:"#6366f1",strokeWidth:2.5,dot:(0,l.jsx)(e=>{let{cx:t,cy:s}=e;return(0,l.jsx)("circle",{cx:t,cy:s,r:6,fill:"#6366f1",stroke:"#fff",strokeWidth:2})},{}),activeDot:{r:6}})]})})}),(0,l.jsxs)("div",{className:"text-xs font-normal -mx-5 p-5 mt-10 text-gray-600 bg-neutral-200/40 flex justify-between",children:[(0,l.jsxs)("div",{className:"flex items-center gap-2",children:["Results For Last Run Completed On",(0,l.jsx)("span",{className:"font-bold text-black",children:R?new Date(Number(R.created_at)).toLocaleString():"-"})]}),(0,l.jsxs)("div",{className:"flex items-center gap-3 mt-2 md:mt-0 relative",children:[(0,l.jsxs)("button",{className:"flex items-center gap-2 rounded-lg shadow-[0px_1px_2px_0px_rgba(0,0,0,0.05)] outline-1 outline-offset-[-1px] outline-neutral-200 bg-white px-3 py-2 hover:shadow transition-all",onClick:()=>X(e=>!e),children:[(0,l.jsx)(v.Kt4,{color:"text-neutral-950",size:16}),(0,l.jsx)("span",{className:"text-neutral-950 text-xs font-normal",children:R?null===(s=R.data)||void 0===s?void 0:s.queryset_name:"Run"}),(0,l.jsx)(f.q2p,{className:"text-black text-lg -ml-1",size:16})]}),U&&(0,l.jsx)("div",{className:"absolute right-0 top-12 z-10 bg-white border border-gray-200 rounded shadow w-48 max-h-56 overflow-y-auto",children:B.map(e=>{var t;return(0,l.jsxs)("div",{className:"px-4 py-2 cursor-pointer hover:bg-gray-100 ".concat((null==R?void 0:R.id)===e.id?"bg-gray-100 font-bold":""),onClick:()=>{F(e),X(!1)},children:[(0,l.jsx)("div",{className:"font-medium",children:null===(t=e.data)||void 0===t?void 0:t.queryset_name}),(0,l.jsx)("div",{className:"text-xs text-gray-500",children:new Date(Number(e.created_at)).toLocaleString()})]},e.id)})})]})]})]}),K&&(0,l.jsx)("div",{className:"text-center py-10",children:"Loading..."}),W&&(0,l.jsx)("div",{className:"text-center text-red-500 py-10",children:W}),!K&&!W&&I&&(0,l.jsx)("div",{className:"bg-white mt-5",children:(0,l.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-8 items-start",children:[(0,l.jsxs)("div",{className:"border-r-[0.8px] border-neutral-200 pr-5",children:[(0,l.jsx)("div",{className:"text-neutral-950 text-base font-semibold mb-9",children:"Share Of Voice"}),(0,l.jsx)("div",{className:"grid grid-cols-1 gap-4",children:(0,l.jsxs)("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[(0,l.jsxs)("div",{className:"bg-primary rounded-lg py-4 px-3 flex flex-col justify-center min-h-[80px]",children:[(0,l.jsxs)("div",{className:"flex items-center mb-2",children:[(0,l.jsx)("div",{className:"w-1 h-4 bg-indigo-400 rounded-2xl mr-2"}),(0,l.jsx)("span",{className:"textPrimary500 text-xs font-medium",children:"Total Questions Run"})]}),(0,l.jsx)("div",{className:" text-zinc-900 text-base font-semibold",children:null!==(P=null===(k=I.result)||void 0===k?void 0:null===(w=k.all)||void 0===w?void 0:null===(g=w.queries)||void 0===g?void 0:g.length)&&void 0!==P?P:"-"})]}),(0,l.jsxs)("div",{className:"bg-primary rounded-lg p-6 flex flex-col justify-center min-h-[80px]",children:[(0,l.jsxs)("div",{className:"flex items-center mb-2",children:[(0,l.jsx)("div",{className:"w-1 h-4 bg-indigo-400 rounded-2xl mr-2"}),(0,l.jsx)("span",{className:"textPrimary500 text-xs font-medium ",children:"My SOV (Brand Mentions)"})]}),(0,l.jsx)("div",{className:" text-zinc-900 text-base font-semibold",children:(null===(_=I.result)||void 0===_?void 0:null===(D=_.own)||void 0===D?void 0:D.sov)?"".concat(I.result.own.sov,"%"):"-"})]}),(0,l.jsxs)("div",{className:"bg-primary rounded-lg p-6 flex flex-col justify-center min-h-[80px]",children:[(0,l.jsxs)("div",{className:"flex items-center mb-2",children:[(0,l.jsx)("div",{className:"w-1 h-4 bg-indigo-400 rounded-2xl mr-2"}),(0,l.jsx)("span",{className:"textPrimary500 text-xs font-medium ",children:"All Brand Mentions"})]}),(0,l.jsx)("div",{className:" text-zinc-900 text-base font-semibold",children:null!==(V=null===(E=I.result)||void 0===E?void 0:null===(A=E.all)||void 0===A?void 0:null===(S=A.brands)||void 0===S?void 0:S.length)&&void 0!==V?V:"-"})]}),(0,l.jsxs)("div",{className:"bg-primary rounded-lg p-6 flex flex-col justify-center min-h-[80px]",children:[(0,l.jsxs)("div",{className:"flex items-center mb-2",children:[(0,l.jsx)("div",{className:"w-1 h-4 bg-indigo-400 rounded-2xl mr-2"}),(0,l.jsx)("span",{className:"textPrimary500 text-xs font-medium ",children:"Citations"})]}),(0,l.jsx)("div",{className:" text-zinc-900 text-base font-semibold",children:null!==(L=null===(C=I.result)||void 0===C?void 0:null===(z=C.all)||void 0===z?void 0:null===(q=z.urls)||void 0===q?void 0:q.length)&&void 0!==L?L:"-"})]})]})})]}),(0,l.jsxs)("div",{className:"border-r-[0.8px] border-neutral-200 pr-5",children:[(0,l.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,l.jsx)("div",{className:"text-neutral-950 text-base font-semibold",children:"Brand Visibility Index"}),(0,l.jsx)("button",{className:"text-black text-xs font-normal",children:"View more"})]}),(0,l.jsx)("div",{className:"text-zinc-700 text-xs font-normal mb-2",children:"Top 10 brands ranked by SOV"}),(0,l.jsxs)("table",{className:"w-full text-xs",children:[(0,l.jsx)("thead",{children:(0,l.jsxs)("tr",{className:"text-gray-400",children:[(0,l.jsx)("th",{className:"text-left text-slate-500 text-xs font-normal"}),(0,l.jsx)("th",{className:"text-left text-slate-500 text-xs font-normal",children:"Brands"}),(0,l.jsx)("th",{className:"text-left text-slate-500 text-xs font-normal",children:"SOV"}),(0,l.jsx)("th",{className:"text-left text-slate-500 text-xs font-normal",children:"Questions"})]})}),(0,l.jsx)("tbody",{children:(()=>{var e,t;let s=(null===(e=I.result)||void 0===e?void 0:e.others)||[],n=(null===(t=I.result)||void 0===t?void 0:t.own)?{name:I.result.own.name||ea,sov:I.result.own.sov,mentions:Array.isArray(I.result.own.queries)?I.result.own.queries.length:I.result.own.mentions||0}:null;return[...s.map(e=>({name:e.name,sov:e.sov,mentions:Array.isArray(e.queries)?e.queries.length:e.mentions||0}))||[],...n?[n]:[]].sort((e,t)=>(t.sov||0)-(e.sov||0)).slice(0,10).map((e,t)=>{var s;return(0,l.jsxs)("tr",{className:"text-[#222] font-medium",children:[(0,l.jsx)("td",{children:t+1}),(0,l.jsxs)("td",{className:"py-1",children:[" ",e.name]}),(0,l.jsx)("td",{className:"py-1 font-bold",children:void 0!==e.sov?"".concat(e.sov.toFixed(2),"%"):"-"}),(0,l.jsx)("td",{className:"py-1",children:null!==(s=e.mentions)&&void 0!==s?s:"-"})]},e.name)})})()})]})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("div",{className:"text-neutral-950 text-base font-semibold mb-2",children:"Your Brand Visibility & Trend"}),(0,l.jsx)("div",{className:"text-zinc-700 text-xs font-normal mb-8",children:"Brand's position compared to industry competitors."}),(0,l.jsxs)("div",{className:"flex items-center justify-between mt-8",children:[(0,l.jsx)("span",{className:"text-zinc-700 text-xs font-normal",children:"Overall Visibility Score"}),(0,l.jsx)("span",{className:"flex items-center gap-2",children:(0,l.jsx)("span",{className:"text-black text-base font-semibold",children:"number"==typeof(null===(M=I.result)||void 0===M?void 0:null===(O=M.own)||void 0===O?void 0:O.sov)?"".concat(I.result.own.sov,"%"):"-"})})]})]})]})})]})}},70753:(e,t,s)=>{(window.__NEXT_P=window.__NEXT_P||[]).push(["/aeo/overview",function(){return s(53435)}])}},e=>{var t=t=>e(e.s=t);e.O(0,[5711,9034,7092,1114,8324,4249,636,6593,8792],()=>t(70753)),_N_E=e.O()}]);