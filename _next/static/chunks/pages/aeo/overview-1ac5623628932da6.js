(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[2305],{7492:(e,t,s)=>{"use strict";s.d(t,{$:()=>i});var a=s(37876);s(14232);var n=s(69241),l=s(95313);let r={default:"bg-gray-500 hover:bg-gray-600 text-white",white:"bg-white hover:bg-gray-100 text-indigo-700 border border-indigo-700",primary:"bgHardBlue hover:bgHardBlue text-white",danger:"bg-red-600 hover:bg-red-700 text-white"},i=e=>{let{variant:t="default",loading:s=!1,children:i,className:d,loaderIcon:o,...c}=e;return(0,a.jsx)("button",{className:(0,n.A)(" text-xs font-semibold px-4 py-2 rounded-lg transition cursor-pointer flex items-center justify-center gap-2",r[t],d),disabled:s||c.disabled,...c,children:s?o||(0,a.jsx)(l.A,{className:"h-4 w-4 animate-spin"}):i})}},53435:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>E});var a=s(37876),n=s(74562),l=s(65259),r=s(43598),i=s(83350),d=s(89099),o=s(14232),c=s(38412);s(16691),s(58198);var x=s(75683),m=s(21976),u=s(94344),h=s(68869),f=s(49325),v=s(94499),b=s(65748),j=s(7623),g=s(19926),p=s(23518),y=s(92889),N=s(6630),w=s(7492);let D=new Date,k=new Date(D);k.setDate(D.getDate()-7),k.setHours(0,0,0,0);let _=new Date(D);_.setHours(23,59,59,999);let S={startDate:k.getTime(),endDate:_.getTime(),key:"selection"},A=()=>{let e=sessionStorage.getItem("date_range");if(!e)return null;let t=JSON.parse(e),s=new Date(t.startDate),a=new Date(t.endDate),n=new Date;return a.getFullYear()===n.getFullYear()&&a.getMonth()===n.getMonth()&&a.getDate()===n.getDate()&&(a=n),{startDate:s.getTime(),endDate:a.getTime(),key:t.key||"selection"}},E=()=>{var e,t,s,D,k,_,E;(0,d.useRouter)();let[O,z]=(0,o.useState)([]),[q,L]=(0,o.useState)(!1),[T,B]=(0,o.useState)(""),[F,P]=(0,o.useState)(null),[V,I]=(0,o.useState)(null),[G,R]=(0,o.useState)(!1),[Y,H]=(0,o.useState)(S),[K,Q]=(0,o.useState)(!1),W=(0,o.useRef)(null),[J,U]=(0,o.useState)(null),X=(0,o.useRef)(null);(0,u.A)([X],()=>R(!1));let $=()=>{sessionStorage.removeItem("date_range"),H(S)},Z="".concat((0,i.GP)(Y.startDate,"MMM dd, yyyy")," â€“ ").concat((0,i.GP)(Y.endDate,"MMM dd, yyyy")),ee=async e=>{var t;let s="/orgs/".concat(null===(t=r.A.current())||void 0===t?void 0:t.id,"/aeoanalysis/tasks?queryset_id=").concat(e);Y.startDate&&Y.endDate&&(s+="&start_date=".concat(Y.startDate,"&end_date=").concat(Y.endDate));let{data:a,error:n}=await l.A.doGet({path:s});if(n){I("Failed to fetch runs"),z([]),L(!1);return}return z(a.tasks||[]),a.tasks.length>0&&P(a.tasks[0]),a.tasks.length},et="My Brand";for(let s of(null==J?void 0:null===(t=J.result)||void 0===t?void 0:null===(e=t.info)||void 0===e?void 0:e.args)||[])if("brand"===s.id){et=(s.value||"").trim().split(",")[0].trim();break}let es=O.map(e=>{var t,s,a,n,l,r,i,d,o;return{date:new Date(Number(e.created_at)).toLocaleDateString("en-GB",{day:"2-digit",month:"short"}),value:Number(null!==(i=null===(s=e.data)||void 0===s?void 0:null===(t=s.result)||void 0===t?void 0:t.sov)&&void 0!==i?i:0),runId:e.id,questions:Number(null!==(d=null===(n=e.data)||void 0===n?void 0:null===(a=n.result)||void 0===a?void 0:a.num_questions)&&void 0!==d?d:0),highlight:!1,sov:Number(null!==(o=null===(r=e.data)||void 0===r?void 0:null===(l=r.result)||void 0===l?void 0:l.sov)&&void 0!==o?o:0),createdAt:Number(e.created_at)}}),ea=e=>{let t=new Date,s=e.endDate?new Date(e.endDate):new Date,a=s.getFullYear()===t.getFullYear()&&s.getMonth()===t.getMonth()&&s.getDate()===t.getDate();return{startDate:e.startDate?new Date(e.startDate).getTime():new Date().getTime(),endDate:a?Date.now():s.getTime(),key:"selection"}};(0,o.useEffect)(()=>{T&&ee(T)},[Y,T]),(0,o.useEffect)(()=>{(async()=>{L(!0);let e=await r.A.checkAndGetAeoProject();if(!e)return I("Project not found"),L(!1),n.A.show("Create new project",(0,a.jsx)(N.default,{}),!0,"90%");B(e.id);let t=A();t&&H(t),setTimeout(()=>{ee(e.id),L(!1)},0)})()},[]);let en=null==F?void 0:null===(s=F.data)||void 0===s?void 0:s.result;return(0,o.useEffect)(()=>{if(K)return document.addEventListener("mousedown",e),()=>{document.removeEventListener("mousedown",e)};function e(e){W.current&&!W.current.contains(e.target)&&Q(!1)}},[K]),(0,o.useEffect)(()=>{let e=async()=>{if(!F)return;I(null);let e="/orgs/".concat(r.A.current().id,"/aeoanalysis/tasks/").concat(F.id,"?fetch_result=true"),t=await l.A.doGet({path:e});if(t.error){I("Failed to fetch analysis data"),L(!1);return}U(t.data.task)};F&&e()},[F]),(0,a.jsxs)("div",{className:"px-5 md:px-5 py-5 md:py-7 bg-white min-h-screen fontDmSans",children:[(0,a.jsx)("div",{className:"flex flex-col md:flex-row md:items-center md:justify-between mb-6 gap-3",children:(0,a.jsx)("h2",{className:"text-2xl font-bold text-black",children:"Share Of Voice"})}),(0,a.jsxs)("div",{className:"border-t border-[#E5E7EB] py-5 mb-4",children:[(0,a.jsxs)("div",{className:"flex flex-col md:flex-row md:items-center md:justify-between mb-4 gap-3",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("div",{className:"text-base font-semibold text-[#222] mb-1",children:"Visibility Score"}),(0,a.jsx)("div",{className:"text-xs text-gray-500 mb-2",children:"Percentage of responses mentioning your Brand over the selected date range."})]}),(0,a.jsx)("div",{className:"flex items-center gap-2 mt-2 md:mt-0",children:(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsxs)("div",{className:"flex gap-2",children:[(0,a.jsx)("button",{className:"flex items-center border border-gray-300 rounded px-3 py-2 text-xs bg-white",onClick:()=>Q(e=>!e),children:(0,a.jsx)("span",{className:"mr-2",children:Z})}),(0,a.jsx)(w.$,{variant:"white",onClick:()=>$(),children:"Clear"})]}),K&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("div",{className:"fixed inset-0 z-10",onClick:()=>Q(!1),style:{background:"transparent"}}),(0,a.jsx)("div",{className:"absolute right-0 z-20 bg-white shadow-lg mt-2 w-[90vw] max-w-xs text-xs md:w-auto md:max-w-none md:text-base",children:(0,a.jsx)(c.ad,{editableDateInputs:!0,onChange:e=>{let t=ea(e.selection);H(t),sessionStorage.setItem("date_range",JSON.stringify(t))},ranges:[{...Y,startDate:new Date(Y.startDate),endDate:new Date(Y.endDate)}],maxDate:new Date})})]})]})})]}),(0,a.jsx)("div",{className:"w-full h-56 relative",children:(0,a.jsx)(h.u,{width:"100%",height:"100%",children:(0,a.jsxs)(f.b,{data:es.reverse(),margin:{top:20,right:40,left:0,bottom:0},children:[(0,a.jsx)("defs",{children:(0,a.jsxs)("linearGradient",{id:"colorUv",x1:"0",y1:"0",x2:"0",y2:"1",children:[(0,a.jsx)("stop",{offset:"0%",stopColor:"#6366f1",stopOpacity:.35}),(0,a.jsx)("stop",{offset:"60%",stopColor:"#6366f1",stopOpacity:.12}),(0,a.jsx)("stop",{offset:"100%",stopColor:"#6366f1",stopOpacity:0})]})}),(0,a.jsx)(v.d,{vertical:!1,strokeDasharray:"3 3",stroke:"#f3f3f3"}),(0,a.jsx)(b.W,{dataKey:"date",axisLine:!1,tickLine:!1,tick:{fontSize:12,fill:"#888"},dy:8}),(0,a.jsx)(j.h,{domain:[0,100],axisLine:!1,tickLine:!1,tick:{fontSize:12,fill:"#888"},dx:-8,ticks:[0,25,50,75,100]}),(0,a.jsx)(g.m,{content:(0,a.jsx)(M,{}),cursor:{stroke:"#6366f1",strokeWidth:1,opacity:.1}}),(0,a.jsx)(p.G,{type:"monotone",dataKey:"value",stroke:"none",fill:"url(#colorUv)"}),(0,a.jsx)(y.N,{type:"monotone",dataKey:"value",stroke:"#6366f1",strokeWidth:2.5,dot:(0,a.jsx)(C,{}),activeDot:{r:6}})]})})}),(0,a.jsxs)("div",{className:"text-xs font-normal -mx-2 md:-mx-5 p-5 mt-10 text-gray-600 bg-neutral-200/40 flex flex-col md:flex-row justify-between gap-2",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2",children:["Results For Last Run Completed On",(0,a.jsx)("span",{className:"font-bold text-black",children:F?new Date(Number(F.created_at)).toLocaleString():"-"})]}),(0,a.jsx)("div",{className:"flex items-center gap-3 mt-2 md:mt-0 relative",children:(0,a.jsxs)("div",{ref:X,className:"relative",children:[(0,a.jsxs)("button",{className:"flex items-center gap-2 rounded-lg shadow-[0px_1px_2px_0px_rgba(0,0,0,0.05)] outline-1 outline-offset-[-1px] outline-neutral-200 bg-white px-3 py-2 hover:shadow transition-all",onClick:()=>R(e=>!e),children:[(0,a.jsx)(m.Kt4,{color:"text-neutral-950",size:16}),(0,a.jsx)("span",{className:"text-neutral-950 text-xs font-normal",children:F?null===(D=F.data)||void 0===D?void 0:D.queryset_name:"Run"}),(0,a.jsx)(x.q2p,{className:"text-black text-lg -ml-1",size:16})]}),G&&(0,a.jsx)("div",{className:"absolute right-0 top-12 z-10 bg-white border border-gray-200 rounded shadow w-48 max-h-56 overflow-y-auto",children:O.map(e=>{var t;return(0,a.jsxs)("div",{className:"px-4 py-2 cursor-pointer hover:bg-gray-100 ".concat((null==F?void 0:F.id)===e.id?"bg-gray-100 font-bold":""),onClick:()=>{P(e),R(!1)},children:[(0,a.jsx)("div",{className:"font-medium",children:null===(t=e.data)||void 0===t?void 0:t.queryset_name}),(0,a.jsx)("div",{className:"text-xs text-gray-500",children:new Date(Number(e.created_at)).toLocaleString()})]},e.id)})})]})})]})]}),q&&(0,a.jsx)("div",{className:"text-center py-10",children:"Loading..."}),V&&(0,a.jsx)("div",{className:"text-center text-red-500 py-10",children:V}),!q&&!V&&en&&(0,a.jsx)("div",{className:"bg-white mt-5",children:(0,a.jsxs)("div",{className:"flex flex-col md:grid md:grid-cols-3 gap-8 items-start",children:[(0,a.jsxs)("div",{className:"border-0 md:border-r-[0.8px] border-neutral-200 w-full flex flex-col items-start justify-center md:pr-5 mb-8 md:mb-0",children:[(0,a.jsx)("div",{className:"text-neutral-950 text-base font-semibold mb-9",children:"Share Of Voice"}),(0,a.jsx)("div",{className:"grid grid-cols-1 gap-4",children:(0,a.jsxs)("div",{className:"grid grid-cols-2 md:grid-cols-2 gap-4",children:[(0,a.jsxs)("div",{className:"bg-primary rounded-lg py-4 px-3 flex flex-col justify-center min-h-[80px]",children:[(0,a.jsxs)("div",{className:"flex items-center mb-2",children:[(0,a.jsx)("div",{className:"w-1 h-4 bg-indigo-400 rounded-2xl mr-2"}),(0,a.jsx)("span",{className:"textPrimary500 text-xs font-medium",children:"Total Questions Run"})]}),(0,a.jsx)("div",{className:" text-zinc-900 text-base font-semibold",children:null!==(k=null==en?void 0:en.num_questions)&&void 0!==k?k:"-"})]}),(0,a.jsxs)("div",{className:"bg-primary rounded-lg p-6 flex flex-col justify-center min-h-[80px]",children:[(0,a.jsxs)("div",{className:"flex items-center mb-2",children:[(0,a.jsx)("div",{className:"w-1 h-4 bg-indigo-400 rounded-2xl mr-2"}),(0,a.jsx)("span",{className:"textPrimary500 text-xs font-medium ",children:"My SOV (Brand Mentions)"})]}),(0,a.jsx)("div",{className:" text-zinc-900 text-base font-semibold",children:(null==en?void 0:en.sov)!==void 0?"".concat(Number(en.sov).toFixed(2),"%"):"-"})]}),(0,a.jsxs)("div",{className:"bg-primary rounded-lg p-6 flex flex-col justify-center min-h-[80px]",children:[(0,a.jsxs)("div",{className:"flex items-center mb-2",children:[(0,a.jsx)("div",{className:"w-1 h-4 bg-indigo-400 rounded-2xl mr-2"}),(0,a.jsx)("span",{className:"textPrimary500 text-xs font-medium ",children:"All Brand Mentions"})]}),(0,a.jsx)("div",{className:" text-zinc-900 text-base font-semibold",children:null!==(_=null==en?void 0:en.num_brands)&&void 0!==_?_:"-"})]}),(0,a.jsxs)("div",{className:"bg-primary rounded-lg p-6 flex flex-col justify-center min-h-[80px]",children:[(0,a.jsxs)("div",{className:"flex items-center mb-2",children:[(0,a.jsx)("div",{className:"w-1 h-4 bg-indigo-400 rounded-2xl mr-2"}),(0,a.jsx)("span",{className:"textPrimary500 text-xs font-medium ",children:"Citations"})]}),(0,a.jsx)("div",{className:" text-zinc-900 text-base font-semibold",children:null!==(E=null==en?void 0:en.num_sources)&&void 0!==E?E:"-"})]})]})})]}),(0,a.jsxs)("div",{className:"border-0 md:border-r-[0.8px] border-neutral-200 pr-0 md:pr-5 mb-8 md:mb-0 w-full overflow-x-auto",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,a.jsx)("div",{className:"text-neutral-950 text-base font-semibold",children:"Brand Visibility Index"}),(0,a.jsx)("button",{className:"text-black text-xs font-normal",children:"View more"})]}),(0,a.jsx)("div",{className:"text-zinc-700 text-xs font-normal mb-5 md:mb-2",children:"Top 10 brands ranked by SOV"}),(0,a.jsx)("div",{className:"w-full overflow-x-auto max-h-[320px] overflow-y-auto scrollbar-hide",children:(0,a.jsxs)("table",{className:"w-full text-xs min-w-[340px]",children:[(0,a.jsx)("thead",{children:(0,a.jsxs)("tr",{className:"text-gray-400",children:[(0,a.jsx)("th",{className:"text-left text-slate-500 text-xs font-normal"}),(0,a.jsx)("th",{className:"text-left text-slate-500 text-xs font-normal",children:"Brands"}),(0,a.jsx)("th",{className:"text-left text-slate-500 text-xs font-normal",children:"SOV"}),(0,a.jsx)("th",{className:"text-left text-slate-500 text-xs font-normal",children:"Questions"})]})}),(0,a.jsx)("tbody",{children:(()=>{var e,t;let s=(null==J?void 0:null===(e=J.result)||void 0===e?void 0:e.others)||[],n=(null==J?void 0:null===(t=J.result)||void 0===t?void 0:t.own)?{name:J.result.own.name||et,sov:J.result.own.sov,mentions:Array.isArray(J.result.own.queries)?J.result.own.queries.length:J.result.own.mentions||0}:null;return[...s.map(e=>({name:e.name,sov:e.sov,mentions:Array.isArray(e.queries)?e.queries.length:e.mentions||0}))||[],...n?[n]:[]].sort((e,t)=>(t.sov||0)-(e.sov||0)).slice(0,50).map((e,t)=>{var s;return(0,a.jsxs)("tr",{className:"text-[#222] font-medium",children:[(0,a.jsx)("td",{children:t+1}),(0,a.jsxs)("td",{className:"py-1",children:[" ",e.name]}),(0,a.jsx)("td",{className:"py-1 font-bold",children:void 0!==e.sov?"".concat(Number(e.sov).toFixed(2),"%"):"-"}),(0,a.jsx)("td",{className:"py-1",children:null!==(s=e.mentions)&&void 0!==s?s:"-"})]},e.name)})})()})]})})]}),(0,a.jsxs)("div",{className:"w-full",children:[(0,a.jsx)("div",{className:"text-neutral-950 text-base font-semibold mb-2",children:"Your Brand Visibility & Trend"}),(0,a.jsx)("div",{className:"text-zinc-700 text-xs font-normal mb-8",children:"Brand's position compared to industry competitors."}),(0,a.jsxs)("div",{className:"flex items-center justify-between mt-8",children:[(0,a.jsx)("span",{className:"text-zinc-700 text-xs font-normal",children:"Overall Visibility Score"}),(0,a.jsx)("span",{className:"flex items-center gap-2",children:(0,a.jsx)("span",{className:"text-black text-base font-semibold",children:"number"==typeof(null==en?void 0:en.sov)?"".concat(Number(en.sov).toFixed(2),"%"):"-"})})]})]})]})})]})},M=e=>{let{active:t,payload:s,label:n}=e,l=(0,d.useRouter)();if(t&&s&&s.length){let e=s[0].payload,t=(0,i.GP)(new Date(e.createdAt),"MMM dd, yyyy, hh:mm:ss a");return(0,a.jsxs)("div",{className:"bg-white border border-gray-200 rounded-lg p-3 shadow text-xs min-w-[140px]",style:{pointerEvents:"auto"},children:[(0,a.jsx)("div",{className:"mb-1 text-black font-semibold",children:t}),(0,a.jsxs)("div",{className:"flex items-center justify-between mb-1 text-black font-medium",children:[(0,a.jsx)("span",{children:"SOV"}),(0,a.jsxs)("span",{className:"font-bold text-green-600",children:[e.sov.toFixed(2),"%"]})]}),(0,a.jsxs)("div",{className:"flex items-center justify-between mb-1 text-black font-medium",children:[(0,a.jsx)("span",{children:"Run ID:"}),(0,a.jsx)("span",{children:e.runId})]}),(0,a.jsxs)("div",{className:"flex items-center justify-between mb-1 text-black font-medium",children:[(0,a.jsx)("span",{children:"Questions:"}),(0,a.jsx)("span",{children:e.questions})]}),(0,a.jsx)("button",{className:"text-blue-600 underline text-xs mt-2 block",type:"button",onClick:()=>l.push("/aeo/history/questions?runId=".concat(e.runId)),children:"View Questions"})]})}return null},C=e=>{let{cx:t,cy:s}=e;return(0,a.jsx)("circle",{cx:t,cy:s,r:6,fill:"#6366f1",stroke:"#fff",strokeWidth:2})}},70753:(e,t,s)=>{(window.__NEXT_P=window.__NEXT_P||[]).push(["/aeo/overview",function(){return s(53435)}])},94344:(e,t,s)=>{"use strict";s.d(t,{A:()=>n});var a=s(14232);let n=(e,t)=>{(0,a.useEffect)(()=>{let s=s=>{!e.some(e=>e.current&&e.current.contains(s.target))&&t(s)};return document.addEventListener("mousedown",s),()=>document.removeEventListener("mousedown",s)},[e,t])}}},e=>{var t=t=>e(e.s=t);e.O(0,[5711,9034,7092,5818,8324,4249,636,6593,8792],()=>t(70753)),_N_E=e.O()}]);