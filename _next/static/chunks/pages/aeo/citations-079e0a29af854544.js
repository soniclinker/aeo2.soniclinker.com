(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[7138],{10377:(e,s,t)=>{(window.__NEXT_P=window.__NEXT_P||[]).push(["/aeo/citations",function(){return t(73795)}])},20477:(e,s,t)=>{"use strict";t.d(s,{A:()=>n});var l=t(37876),a=t(68951),i=t.n(a),r=t(46104);t(14232);let n=e=>{let{isOpen:s,onClose:t,title:a,children:n}=e;return s?(0,l.jsxs)("div",{className:"jsx-593ab1484ff139da fixed inset-0 z-50 flex",children:[(0,l.jsx)("div",{onClick:t,className:"jsx-593ab1484ff139da fixed inset-0 bg-black/20 transition-opacity"}),(0,l.jsxs)("div",{className:"jsx-593ab1484ff139da ml-auto w-full md:w-1/2 h-full bg-white shadow-xl p-6 relative animate-slide-in-right overflow-y-auto",children:[(0,l.jsx)("button",{onClick:t,"aria-label":"Close",className:"jsx-593ab1484ff139da absolute top-4 right-4 text-2xl text-gray-400 hover:text-gray-700",children:(0,l.jsx)(r.A,{className:"cursor-pointer",size:20})}),n]}),(0,l.jsx)(i(),{id:"593ab1484ff139da",children:"@-webkit-keyframes slide-in-right{from{-webkit-transform:translatex(100%);transform:translatex(100%)}to{-webkit-transform:translatex(0);transform:translatex(0)}}@-moz-keyframes slide-in-right{from{-moz-transform:translatex(100%);transform:translatex(100%)}to{-moz-transform:translatex(0);transform:translatex(0)}}@-o-keyframes slide-in-right{from{-o-transform:translatex(100%);transform:translatex(100%)}to{-o-transform:translatex(0);transform:translatex(0)}}@keyframes slide-in-right{from{-webkit-transform:translatex(100%);-moz-transform:translatex(100%);-o-transform:translatex(100%);transform:translatex(100%)}to{-webkit-transform:translatex(0);-moz-transform:translatex(0);-o-transform:translatex(0);transform:translatex(0)}}.animate-slide-in-right{-webkit-animation:slide-in-right.3s cubic-bezier(.4,0,.2,1);-moz-animation:slide-in-right.3s cubic-bezier(.4,0,.2,1);-o-animation:slide-in-right.3s cubic-bezier(.4,0,.2,1);animation:slide-in-right.3s cubic-bezier(.4,0,.2,1)}"})]}):null}},42059:(e,s,t)=>{"use strict";t.d(s,{A:()=>r});var l=t(37876);t(14232);var a=t(89099);let i=()=>{let e=(0,a.useRouter)(),s=e.asPath,t=s.split("/").filter(e=>!(""===e||e.startsWith("?")||e.startsWith("#"))),i=t.map((a,i)=>{let r=i===t.length-1;return(0,l.jsxs)("div",{className:"inline",children:[(0,l.jsx)("span",{className:"text-[#737373] font-medium capitalize cursor-pointer hover:underline",onClick:()=>{if(r)return;let l="/".concat(t.slice(0,i+1).join("/"));l!==s&&l!=="/".concat(t[0])&&e.push(l)},children:a.replace(/-/g," ")}),!r&&(0,l.jsx)("span",{className:"text-[#737373] font-medium",children:" > "})]},i)});return(0,l.jsx)("div",{children:i})},r=e=>{let{children:s}=e;return(0,l.jsxs)("div",{className:"w-full bg-white border-b-[1px] border-gray-200 p-4 flex justify-between items-center gap-4 flex-wrap",children:[(0,l.jsx)(i,{}),s&&(0,l.jsx)("div",{className:"flex gap-4 items-center justify-between",children:s})]})}},73795:(e,s,t)=>{"use strict";t.r(s),t.d(s,{default:()=>p});var l=t(37876),a=t(14232),i=t(7972),r=t(9614),n=t(89099),d=t(65259),o=t(43598),c=t(20477);let x=e=>{let{domain:s,data:t,urlToQueryCount:a,domainCitedCount:i}=e;return(0,l.jsxs)("div",{children:[(0,l.jsxs)("div",{className:"text-indigo-600 text-base font-bold mb-9",children:["Domain: ",s]}),(0,l.jsxs)("div",{className:"hidden md:grid grid-cols-4 gap-0 bg-neutral-100/50 border-b-[0.80px] border-neutral-200 text-neutral-500 text-xs font-semibold ",children:[(0,l.jsx)("div",{className:"px-2 py-2",children:"Webpage URL"}),(0,l.jsx)("div",{className:"px-2 py-2",children:"Topics"}),(0,l.jsx)("div",{className:"px-2 py-2",children:"Cited"}),(0,l.jsx)("div",{className:"px-2 py-2",children:"Questions"})]}),t.map((e,s)=>{var t,r;return(0,l.jsxs)("div",{className:"hidden md:grid grid-cols-4 gap-0 border-b-[0.80px] border-neutral-200 text-xs items-center",children:[(0,l.jsx)("div",{className:"px-2 py-2 text-blue-700 underline cursor-pointer break-all",children:e.url}),(0,l.jsx)("div",{className:"px-2 py-2",children:e.topic||"-"}),(0,l.jsx)("div",{className:"px-2 py-2",children:null!=i?i:"-"}),(0,l.jsx)("div",{className:"px-2 py-2",children:a?null!==(t=a[e.url])&&void 0!==t?t:"-":null!==(r=e.cited)&&void 0!==r?r:"-"})]},e.url+s)}),(0,l.jsx)("div",{className:"block md:hidden",children:t.map((e,s)=>{var t,r;return(0,l.jsx)("div",{className:" rounded shadow-[0px_1px_2px_-1px_rgba(0,0,0,0.10)] outline-[0.50px] outline-offset-[-0.50px] outline-slate-200 p-4 mb-3 bg-white",children:(0,l.jsxs)("div",{className:"flex justify-between gap-4",children:[(0,l.jsxs)("div",{className:"flex flex-col justify-between min-w-0",children:[(0,l.jsxs)("div",{children:[(0,l.jsx)("div",{className:"text-sm text-gray-500",children:"Web Url:"}),(0,l.jsx)("a",{href:e.url,target:"_blank",rel:"noopener noreferrer",className:"text-blue-600 font-semibold break-all",children:e.url})]}),(0,l.jsxs)("div",{className:"flex items-center gap-2 mt-4",children:[(0,l.jsx)("span",{className:"text-sm text-gray-500",children:"Topic:"}),(0,l.jsx)("span",{className:"bg-gray-200 text-gray-700 text-xs font-medium px-2 py-0.5 rounded",children:e.topic||"Others"})]})]}),(0,l.jsxs)("div",{className:"flex flex-col items-end justify-between text-sm text-gray-500 flex-shrink-0",children:[(0,l.jsxs)("div",{className:"text-right",children:["Cited: ",(0,l.jsx)("span",{className:"font-bold text-black text-lg",children:null!=i?i:"-"})]}),(0,l.jsxs)("div",{className:"text-right",children:["Questions: ",(0,l.jsx)("span",{className:"font-bold text-black text-lg",children:a?null!==(t=a[e.url])&&void 0!==t?t:"-":null!==(r=e.cited)&&void 0!==r?r:"-"})]})]})]})},e.url+s+"-card")})})]})};var m=t(42059),u=t(74562),f=t(6630),h=t(94344);let p=()=>{var e,s,t,p,v,b,j,g,N,y,w,k,_;let E=(0,n.useRouter)().query.runId,[C,q]=(0,a.useState)([]),[z,A]=(0,a.useState)(null),[S,D]=(0,a.useState)(null),[F,M]=(0,a.useState)(!1),[P,T]=(0,a.useState)(null),[R,L]=(0,a.useState)(!1),[B,O]=(0,a.useState)(null),[Q,W]=(0,a.useState)(!1),G=(0,a.useRef)(null),V=(0,a.useRef)(null);(0,h.A)([G,V],()=>L(!1));let H=((null==S?void 0:null===(s=S.result)||void 0===s?void 0:null===(e=s.all)||void 0===e?void 0:e.domains)||[]).map(e=>({domain:e.name,frequency:e.num_urls,source:e.type||"-",viewMore:"#"})),[U,X]=(0,a.useState)(1),I=Math.ceil(H.length/10),K=H.slice((U-1)*10,10*U);(0,a.useEffect)(()=>{U>I&&X(1)},[H,I,U]),(0,a.useEffect)(()=>{(async()=>{M(!0),T(null);let e=await o.A.checkAndGetAeoProject();if(!e)return T("Project not found"),M(!1),u.A.show("Create new project",(0,l.jsx)(f.default,{}),!0,"90%");let{data:s,error:t}=await d.A.doGet({path:"/orgs/".concat(o.A.current().id,"/aeoanalysis/tasks?queryset_id=").concat(e.id)});if(t){T("Failed to fetch runs"),M(!1);return}if(q(s.tasks||[]),E&&s.tasks){let e=s.tasks.find(e=>e.id===E);e?A(e):s.tasks.length>0&&A(s.tasks[0])}else s.tasks&&s.tasks.length>0&&A(s.tasks[0]);M(!1)})()},[E]);let J=e=>{A(e),L(!1)};(0,a.useEffect)(()=>{let e=async()=>{if(!z)return;M(!0),T(null);let{data:e,error:s}=await d.A.doGet({path:"/orgs/".concat(o.A.current().id,"/aeoanalysis/tasks/").concat(z.id,"?fetch_result=true")});if(s){T("Failed to fetch analysis data"),M(!1);return}D(e.task),M(!1)};z&&e()},[z]);let Y=(null==z?void 0:z.name)||(null==z?void 0:null===(t=z.data)||void 0===t?void 0:t.queryset_name)||(null==z?void 0:z.id)||"-",Z=z?new Date(Number(z.created_at)).toLocaleString():"-",$=null!==(w=null==S?void 0:null===(b=S.result)||void 0===b?void 0:null===(v=b.all)||void 0===v?void 0:null===(p=v.queries)||void 0===p?void 0:p.length)&&void 0!==w?w:"-",ee=[];B&&S&&(ee=((null===(_=S.result)||void 0===_?void 0:null===(k=_.all)||void 0===k?void 0:k.urls)||[]).filter(e=>e.link&&e.link.includes(B||"")).map(e=>({url:e.link,topic:e.type||"-",cited:e.cited,questions:e.questions,sov:e.sov})));let es={};(null==S?void 0:null===(g=S.result)||void 0===g?void 0:null===(j=g.all)||void 0===j?void 0:j.queries)&&S.result.all.queries.forEach(e=>{e.urls.forEach(e=>{e.includes(B||"")&&(es[e]=(es[e]||0)+1)})});let et=0;return B&&(null==S?void 0:null===(y=S.result)||void 0===y?void 0:null===(N=y.all)||void 0===N?void 0:N.queries)&&S.result.all.queries.forEach(e=>{e.urls.forEach(e=>{e.includes(B)&&et++})}),(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(m.A,{}),(0,l.jsxs)("div",{className:"bg-white min-h-screen fontDmSans",children:[(0,l.jsx)("div",{className:"bg-violet-50/70 px-6 py-4 flex flex-col md:flex-row md:items-center md:justify-between mb-4",children:(0,l.jsxs)("div",{className:"flex items-center gap-2 text-[#6C47FF] text-base font-medium relative",children:[(0,l.jsx)("span",{className:"text-slate-600 text-xs font-semibold pr-2",children:"Select Run :"}),(0,l.jsxs)("span",{ref:G,className:"text-slate-500 text-xs font-semibold ml-2 flex items-center gap-1 cursor-pointer select-none relative",onClick:()=>L(e=>!e),children:[Y,(0,l.jsx)(i.fK4,{size:16}),R&&(0,l.jsx)("div",{ref:V,className:"absolute left-0 top-6 z-10 bg-white border border-gray-200 rounded shadow w-48 max-h-56 overflow-y-auto",children:C.map(e=>{var s;return(0,l.jsxs)("div",{className:"px-4 py-2 cursor-pointer hover:bg-gray-100 ".concat((null==z?void 0:z.id)===e.id?"bg-gray-100 font-bold":""),onClick:()=>J(e),children:[(0,l.jsx)("div",{className:"font-medium",children:e.name||(null===(s=e.data)||void 0===s?void 0:s.queryset_name)||e.id}),(0,l.jsx)("div",{className:"text-xs text-gray-500",children:new Date(Number(e.created_at)).toLocaleString()})]},e.id)})})]}),(0,l.jsx)("span",{className:"text-slate-500 text-xs font-semibold ml-2 pr-2",children:Z}),(0,l.jsxs)("span",{className:"text-slate-500 text-xs font-semibold ml-1",children:[$," Questions"]})]})}),(0,l.jsxs)("div",{className:"w-full overflow-x-auto",children:[(0,l.jsxs)("div",{className:"hidden md:grid min-w-[700px] w-full grid-cols-4 gap-0 px-6 py-3 border-b border-neutral-200 text-neutral-500 text-xs bg-neutral-100/50 font-semibold",children:[(0,l.jsx)("div",{className:"",children:"Top Domains"}),(0,l.jsxs)("div",{className:"flex items-center gap-1",children:["Frequency ",(0,l.jsx)("span",{className:"text-gray-400",children:(0,l.jsx)(r.H2l,{size:16,className:"text-neutral-500"})})]}),(0,l.jsxs)("div",{className:"flex items-center gap-1",children:["Source ",(0,l.jsx)("span",{className:"text-gray-400",children:(0,l.jsx)(r.H2l,{size:16,className:"text-neutral-500"})})]}),(0,l.jsx)("div",{className:"",children:"View More"})]}),(0,l.jsx)("div",{className:"hidden md:grid min-w-[700px] w-full text-xs grid-cols-4",children:K.map((e,s)=>[(0,l.jsx)("div",{className:"col-span-1 border-b border-[#E5E7EB] bg-white items-center text-neutral-900 text-xs font-medium px-6 md:px-6 py-3",children:e.domain},e.domain+s+"-domain"),(0,l.jsx)("div",{className:"col-span-1 border-b border-[#E5E7EB] bg-white items-center text-neutral-950 text-xs font-normal py-3",children:e.frequency},e.domain+s+"-freq"),(0,l.jsx)("div",{className:"col-span-1 border-b border-[#E5E7EB] bg-white items-center text-neutral-700 text-xs font-normal py-3",children:e.source},e.domain+s+"-source"),(0,l.jsx)("div",{className:"col-span-1 border-b border-[#E5E7EB] bg-white text-sm items-center py-3",children:(0,l.jsx)("button",{className:"text-indigo-600 hover:underline text-xs font-medium",onClick:()=>{O(e.domain),W(!0)},children:"View More"})},e.domain+s+"-view")])}),(0,l.jsx)("div",{className:"block md:hidden",children:K.map((e,s)=>(0,l.jsx)("div",{className:"mx-4 my-1 rounded shadow-[0px_1px_2px_-1px_rgba(0,0,0,0.10)] outline-[0.50px] outline-offset-[-0.50px] outline-slate-200 p-4 mb-3 bg-white text-sm",children:(0,l.jsxs)("div",{className:"flex justify-between gap-4",children:[(0,l.jsxs)("div",{className:"flex flex-col justify-between min-w-0",children:[(0,l.jsxs)("div",{children:[(0,l.jsx)("div",{className:"text-gray-500 text-xs",children:"Top Domain :"}),(0,l.jsx)("div",{className:"text-black font-bold text-base break-words",children:e.domain})]}),(0,l.jsxs)("div",{className:"text-gray-500 text-xs mt-2",children:["Frequency: ",e.frequency]})]}),(0,l.jsxs)("div",{className:"flex flex-col justify-between items-end flex-shrink-0",children:[(0,l.jsxs)("div",{className:"text-gray-500 flex flex-col items-end text-xs",children:["Sources:",(0,l.jsx)("span",{className:"mt-1 bg-gray-200 text-gray-600 text-xs font-medium px-2 py-0.5 rounded",children:e.source})]}),(0,l.jsx)("button",{className:"text-blue-600 hover:underline text-sm font-medium mt-2",onClick:()=>{O(e.domain),W(!0)},children:"View More"})]})]})},e.domain+s+"-card"))})]}),I>1&&(0,l.jsxs)("div",{className:"flex justify-end items-center mt-4 px-6",children:[(0,l.jsx)("button",{className:"ml-2 px-2 py-1 border rounded disabled:opacity-50",onClick:()=>X(e=>Math.max(1,e-1)),disabled:1===U,children:"Prev"}),(0,l.jsxs)("span",{className:"mx-2 text-xs",children:["Page ",U," of ",I]}),(0,l.jsx)("button",{className:"px-2 py-1 border rounded disabled:opacity-50",onClick:()=>X(e=>Math.min(I,e+1)),disabled:U===I,children:"Next"})]}),(0,l.jsx)(c.A,{isOpen:Q,onClose:()=>W(!1),title:B?"Domain: ".concat(B):"",children:(0,l.jsx)("div",{className:"w-full",children:(0,l.jsx)("div",{className:"md:min-w-[600px] w-full text-xs",children:(0,l.jsx)(x,{domain:B||"",data:ee,urlToQueryCount:es,domainCitedCount:et})})})})]})]})}},94344:(e,s,t)=>{"use strict";t.d(s,{A:()=>a});var l=t(14232);let a=(e,s)=>{(0,l.useEffect)(()=>{let t=t=>{!e.some(e=>e.current&&e.current.contains(t.target))&&s(t)};return document.addEventListener("mousedown",t),()=>document.removeEventListener("mousedown",t)},[e,s])}}},e=>{var s=s=>e(e.s=s);e.O(0,[7141,9034,6703,4249,636,6593,8792],()=>s(10377)),_N_E=e.O()}]);