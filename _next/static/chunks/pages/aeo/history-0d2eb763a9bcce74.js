(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[8672],{3717:e=>{"use strict";e.exports="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED"},7492:(e,t,s)=>{"use strict";s.d(t,{$:()=>l});var a=s(37876);s(14232);var n=s(69241),r=s(95313);let i={default:"bg-gray-500 hover:bg-gray-600 text-white",white:"bg-white hover:bg-gray-100 text-indigo-700 border border-indigo-700",primary:"bgHardBlue hover:bgHardBlue text-white",danger:"bg-red-600 hover:bg-red-700 text-white"},l=e=>{let{variant:t="default",loading:s=!1,children:l,className:c,loaderIcon:d,...o}=e;return(0,a.jsx)("button",{className:(0,n.A)(" text-xs font-semibold px-4 py-2 rounded-lg transition cursor-pointer flex items-center justify-center gap-2",i[t],c),disabled:s||o.disabled,...o,children:s?d||(0,a.jsx)(r.A,{className:"h-4 w-4 animate-spin"}):l})}},31984:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>j});var a=s(37876),n=s(14232),r=s(7972),i=s(7492),l=s(9614),c=s(89099),d=s(65259),o=s(43598),u=s(42059),x=s(74562),m=s(6630),h=s(38412);s(16691),s(58198);var g=s(83350),f=s(16821);let p={running:"bg-blue-100 text-blue-600",completed:"bg-green-100 text-green-600",failed:"bg-red-100 text-red-500"},j=()=>{let e=(0,c.useRouter)(),[t,s]=(0,n.useState)([]),[f,j]=(0,n.useState)(null),[b,v]=(0,n.useState)(!1),[N,w]=(0,n.useState)(!1),[k,A]=(0,n.useState)(null),[_,S]=(0,n.useState)([{startDate:new Date,endDate:new Date,key:"selection"}]),[D,C]=(0,n.useState)(!1),E="".concat((0,g.GP)(_[0].startDate,"MMM dd, yyyy")," â€“ ").concat((0,g.GP)(_[0].endDate,"MMM dd, yyyy")),q=(0,n.useRef)(null),[R,P]=(0,n.useState)(!1),O=async()=>{var e;w(!0),A(null);let t=await o.A.checkAndGetAeoProject();if(!t)return A("Project not found"),w(!1),x.A.show("Create new project",(0,a.jsx)(m.default,{}),!0,"90%");let{data:n,error:r}=await d.A.doGet({path:"/orgs/".concat(null===(e=o.A.current())||void 0===e?void 0:e.id,"/aeoanalysis/tasks?queryset_id=").concat(t.id)});if(r){A("Failed to fetch runs"),s([]),w(!1);return}if(s(n.tasks||[]),n.tasks){if(n.tasks.length>0)j(n.tasks[0]);else{let{id:e}=await o.A.checkAndGetAeoProject();if(!e)return;x.A.show("Create New Run",(0,a.jsx)(y,{id:e,setRefetchRuns:P,fetchProjectAndRuns:O}),!1,"50%")}}w(!1)};(0,n.useEffect)(()=>{O()},[R]);let T=t.filter(e=>{let t=new Date(Number(e.created_at));t.setHours(0,0,0,0);let s=new Date(_[0].startDate);s.setHours(0,0,0,0);let a=new Date(_[0].endDate);return a.setHours(0,0,0,0),t>=s&&t<=a});return(0,n.useEffect)(()=>{if(D)return document.addEventListener("mousedown",e),()=>{document.removeEventListener("mousedown",e)};function e(e){q.current&&!q.current.contains(e.target)&&C(!1)}},[D]),(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("div",{className:"flex flex-col md:flex-row md:items-center md:justify-between gap-3",children:(0,a.jsxs)(u.A,{children:[(0,a.jsx)("div",{className:"flex gap-2",children:(0,a.jsx)(i.$,{variant:"primary",className:"hover:bg-[#5a3fd6] transition-all",onClick:async()=>{let{id:e}=await o.A.checkAndGetAeoProject();e&&x.A.show("Create New Run",(0,a.jsx)(y,{id:e,setRefetchRuns:P,fetchProjectAndRuns:O}),!1,"50%")},children:"Create New Run"})}),(0,a.jsx)("div",{className:"flex items-center gap-2",children:(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsxs)("button",{className:"flex items-center border border-gray-300 rounded-lg px-3 py-2 text-xs bg-white",onClick:()=>C(e=>!e),children:[(0,a.jsx)("span",{className:"mr-2",children:E}),(0,a.jsx)(r.fK4,{className:"text-base"})]}),D&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("div",{className:"fixed inset-0 z-10",onClick:()=>C(!1),style:{background:"transparent"}}),(0,a.jsx)("div",{className:"absolute right-0 z-20 bg-white shadow-lg mt-2",children:(0,a.jsx)(h.ad,{editableDateInputs:!0,onChange:e=>{let t=e.selection;S([{startDate:t.startDate?new Date(t.startDate):new Date,endDate:t.endDate?new Date(t.endDate):new Date,key:"selection"}])},moveRangeOnFirstSelection:!1,ranges:_,maxDate:new Date})})]})]})})]})}),(0,a.jsxs)("div",{className:"px-4 py-6 bg-white min-h-screen fontDmSans",children:[(0,a.jsxs)("div",{className:"grid grid-cols-7 gap-0 px-6 py-3 rounded-t-lg border-b border-neutral-200 text-neutral-500 text-xs font-medium ",children:[(0,a.jsxs)("div",{className:"flex items-center gap-1",children:["SOV ",(0,a.jsx)("span",{className:"text-gray-400",children:(0,a.jsx)(l.H2l,{size:16,className:"text-neutral-500"})})]}),(0,a.jsxs)("div",{className:"flex items-center gap-1",children:["Start Time ",(0,a.jsx)("span",{className:"text-gray-400",children:(0,a.jsx)(l.H2l,{size:16,className:"text-neutral-500"})})]}),(0,a.jsxs)("div",{className:"flex items-center gap-1",children:["Questions ",(0,a.jsx)("span",{className:"text-gray-400",children:(0,a.jsx)(l.H2l,{size:16,className:"text-neutral-500"})})]}),(0,a.jsxs)("div",{className:"flex items-center gap-1",children:["Status ",(0,a.jsx)("span",{className:"text-gray-400",children:(0,a.jsx)(l.H2l,{size:16,className:"text-neutral-500"})})]}),(0,a.jsxs)("div",{className:"flex items-center gap-1",children:["More ",(0,a.jsx)("span",{className:"text-gray-400",children:(0,a.jsx)(l.H2l,{size:16,className:"text-neutral-500"})})]}),(0,a.jsx)("div",{})]}),N&&(0,a.jsx)("div",{className:"flex items-center justify-center py-8",children:(0,a.jsx)("div",{className:"animate-spin rounded-full h-10 w-10 border-b-2 border-gray-900"})}),!N&&k&&(0,a.jsx)("div",{className:"flex items-center justify-center py-8",children:(0,a.jsx)("span",{className:"text-red-500",children:k})}),!N&&!k&&0===t.length&&(0,a.jsx)("div",{className:"flex items-center justify-center py-8",children:(0,a.jsx)("span",{className:"text-gray-400",children:"No runs found for this question set."})}),!N&&!k&&T.map(t=>{let s=t.data&&"object"==typeof t.data&&"result"in t.data?t.data.result:void 0,n=s&&void 0!==s.sov?"".concat(Number(s.sov).toFixed(2),"%"):"--",r=s&&void 0!==s.num_questions?"".concat(s.num_questions):"--",i=t.status?t.status.toLowerCase():"unknown";return(0,a.jsxs)("div",{className:"grid grid-cols-7 gap-0 px-6 py-3 border-b border-[#E5E7EB] items-center text-sm",children:[(0,a.jsx)("div",{className:"text-neutral-900 text-xs font-medium",children:n}),(0,a.jsx)("div",{className:"text-black text-xs font-normal",children:new Date(Number(t.created_at)).toLocaleString()}),(0,a.jsx)("div",{className:"text-neutral-950 text-xs font-normal",children:r}),(0,a.jsx)("div",{children:(0,a.jsx)("span",{className:"px-3 py-1 rounded-full text-xs font-semibold ".concat(p[i]||""),children:t.status})}),(0,a.jsxs)("div",{className:"flex gap-3",children:[(0,a.jsx)("button",{className:"text-indigo-600 hover:underline text-xs font-medium",onClick:()=>e.push("/aeo/history/questions?runId=".concat(t.id)),children:"View Questions"}),(0,a.jsx)("button",{className:"text-indigo-600 hover:underline text-xs font-medium",onClick:()=>e.push("/aeo/citations?runId=".concat(t.id)),children:"View Citations"})]}),(0,a.jsx)("div",{})]},t.id)}),(0,a.jsx)("div",{className:"flex justify-end items-center mt-4",children:(0,a.jsxs)("button",{className:"flex items-center border border-gray-300 rounded px-3 py-2 text-xs bg-white",children:["10 Per Page",(0,a.jsx)(r.fK4,{className:"ml-2 text-base"})]})})]})]})},y=e=>{let{id:t,setRefetchRuns:s,fetchProjectAndRuns:r}=e;(0,c.useRouter)();let[i,l]=(0,n.useState)(!1),[u,m]=(0,n.useState)(null),[h,g]=(0,n.useState)([]),[p,j]=(0,n.useState)(!1),[y,b]=(0,n.useState)(!1),[v,N]=(0,n.useState)(!1),[w,k]=(0,n.useState)([]),[A,_]=(0,n.useState)(!1),[S,D]=(0,n.useState)({}),C=(0,n.useRef)(null),E=(0,n.useRef)(null),q=(e,t)=>{e.target.checked?k(e=>[...e,t]):k(e=>e.filter(e=>e!==t))},R=(0,n.useCallback)(async e=>{let{loader:s}=e;0===h.length&&s&&l(!0);let{data:a,error:n}=await d.A.doGet({path:"/orgs/".concat(o.A.current().id,"/querysets/").concat(t,"/queries")});if(n){console.log(n),m("Something went wrong"),l(!1);return}if(a){if(0===a.queries.length){m("No questions found"),g([]),l(!1),j(!1);return}m(null),g(a.queries),j(!1),l(!1)}},[t,h.length]),P=(0,n.useCallback)(async()=>{let{data:e,error:s}=await d.A.doGet({path:"/orgs/".concat(o.A.current().id,"/querysets/").concat(t)});if(s){m("Something went wrong");return}e&&D(e.queryset.data.args),e&&"running"===e.queryset.task_status?j(!0):R({loader:!1})},[t,R]),O=async()=>{b(!0),console.log(w);let{data:e,error:a}=await d.A.doPost({path:"/orgs/".concat(o.A.current().id,"/aeoanalysis/tasks?queryset_id=").concat(t,"&query_ids=").concat(JSON.stringify(w)),data:{queries:w}});if(a){m(a.message),b(!1),console.log(a);return}if(e){if(!e.id){b(!1),m("Something went wrong");return}m(null),s(e=>!e),x.A.hide()}};return(0,n.useEffect)(()=>{P()},[v,P]),(0,n.useEffect)(()=>{let e=f.A.getInstance(o.A.current().id),t=e=>{console.log(e),"analysis_task_status"===e.type&&(console.log("fetching task status"),r()),"query_task_status"===e.type&&R({loader:!1})};return e.on("message",t),()=>{e.off("message",t)}},[R,s]),(0,n.useEffect)(()=>{let e=e=>{var t,s;(null===(t=C.current)||void 0===t?void 0:t.contains(e.target))||(null===(s=E.current)||void 0===s?void 0:s.contains(e.target))||_(!1)};return document.addEventListener("mousedown",e),()=>document.removeEventListener("mousedown",e)},[]),(0,a.jsxs)("div",{className:"bg-white  min-h-[calc(100vh-80px)]",children:[(0,a.jsxs)("div",{className:"flex justify-between items-center p-2 lg:p-5 bg-white sticky top-0 z-20",children:[(0,a.jsx)("div",{className:"flex items-center justify-center gap-4",children:(0,a.jsx)("h2",{className:"text-sm lg:text-xl font-semibold text-[#1E2035] ",children:"List of questions"})}),(0,a.jsx)("div",{className:"flex items-center gap-2",children:h.length>0&&(0,a.jsx)("button",{className:"px-2 py-1 bg-blue-600 text-white rounded cursor-pointer disabled:bg-gray-500 disabled:opacity-50 disabled:cursor-not-allowed hidden sm:block",onClick:O,disabled:p||y||0===w.length,children:"Analyze"})})]}),i&&(0,a.jsx)("div",{className:"flex items-center justify-center",children:(0,a.jsx)("div",{className:"animate-spin rounded-full h-10 w-10 border-b-2 border-gray-900"})}),!i&&!p&&u&&(0,a.jsx)("div",{className:"flex items-center justify-center",children:(0,a.jsx)("span",{className:"text-red-500",children:u})}),p&&(0,a.jsx)("p",{className:"text-center",children:"We are generating questions for you, please wait..."}),!i&&!p&&h.length>0&&(0,a.jsxs)("div",{className:"sm:m-6 sm:mt-0",children:[(0,a.jsxs)("div",{className:"flex gap-3 sm:gap-4 md:gap-5 lg:gap-6 bg-gray-100 text-gray-700 font-medium py-3 px-5 sticky top-12 lg:top-18",children:[(0,a.jsx)("div",{className:"flex items-center justify-center",children:(0,a.jsx)("input",{type:"checkbox",onChange:()=>{h.length===w.length?k([]):k(h.map(e=>e.id))},checked:w.length===h.length,className:"w-4 h-4"})}),(0,a.jsx)("div",{className:"text-sm lg:text-base flex-1 h-full",children:"Questions"})]}),h.map(e=>(0,a.jsxs)("div",{className:"flex items-center gap-30 sm:gap-4 md:gap-5 lg-gap-6 py-4 px-5 border-b border-l border-r border-gray-100 hover:bg-gray-50",children:[(0,a.jsx)("div",{className:"text-sm lg:text-base h-full flex items-center justify-center",children:(0,a.jsx)("input",{type:"checkbox",id:e.id,name:e.id,checked:w.includes(e.id),onChange:t=>q(t,e.id),className:"w-4 h-4"})}),(0,a.jsx)("div",{className:"text-sm lg:text-base flex-1 h-full",children:e.question})]},e.id))]})]})}},36909:(e,t,s)=>{(window.__NEXT_P=window.__NEXT_P||[]).push(["/aeo/history",function(){return s(31984)}])},42059:(e,t,s)=>{"use strict";s.d(t,{A:()=>i});var a=s(37876);s(14232);var n=s(89099);let r=()=>{let e=(0,n.useRouter)(),t=e.asPath,s=t.split("/").filter(e=>!(""===e||e.startsWith("?")||e.startsWith("#"))),r=s.map((n,r)=>{let i=r===s.length-1;return(0,a.jsxs)("div",{className:"inline",children:[(0,a.jsx)("span",{className:"text-[#737373] font-medium capitalize cursor-pointer hover:underline",onClick:()=>{if(i)return;let a="/".concat(s.slice(0,r+1).join("/"));a!==t&&a!=="/".concat(s[0])&&e.push(a)},children:n.replace(/-/g," ")}),!i&&(0,a.jsx)("span",{className:"text-[#737373] font-medium",children:" > "})]},r)});return(0,a.jsx)("div",{children:r})},i=e=>{let{children:t}=e;return(0,a.jsxs)("div",{className:"w-full bg-white border-b-[1px] border-gray-200 p-4 flex justify-between items-center gap-4 flex-wrap",children:[(0,a.jsx)(r,{}),t&&(0,a.jsx)("div",{className:"flex gap-4 items-center justify-between",children:t})]})}},69241:(e,t,s)=>{"use strict";s.d(t,{A:()=>a});let a=function(){for(var e,t,s=0,a="",n=arguments.length;s<n;s++)(e=arguments[s])&&(t=function e(t){var s,a,n="";if("string"==typeof t||"number"==typeof t)n+=t;else if("object"==typeof t){if(Array.isArray(t)){var r=t.length;for(s=0;s<r;s++)t[s]&&(a=e(t[s]))&&(n&&(n+=" "),n+=a)}else for(a in t)t[a]&&(n&&(n+=" "),n+=a)}return n}(e))&&(a&&(a+=" "),a+=t);return a}},79706:(e,t,s)=>{"use strict";var a=s(3717);function n(){}function r(){}r.resetWarningCache=n,e.exports=function(){function e(e,t,s,n,r,i){if(i!==a){var l=Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw l.name="Invariant Violation",l}}function t(){return e}e.isRequired=e;var s={array:e,bigint:e,bool:e,func:e,number:e,object:e,string:e,symbol:e,any:e,arrayOf:t,element:e,elementType:e,instanceOf:t,node:e,objectOf:t,oneOf:t,oneOfType:t,shape:t,exact:t,checkPropTypes:r,resetWarningCache:n};return s.PropTypes=s,s}},95062:(e,t,s)=>{e.exports=s(79706)()},95313:(e,t,s)=>{"use strict";s.d(t,{A:()=>a});let a=(0,s(95551).A)("LoaderCircle",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]])}},e=>{var t=t=>e(e.s=t);e.O(0,[7141,9034,1114,4249,636,6593,8792],()=>t(36909)),_N_E=e.O()}]);