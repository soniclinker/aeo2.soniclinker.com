"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[7525],{16821:(e,t,r)=>{r.d(t,{A:()=>c});var a=r(42874),n=r(80498),s=r(3176),i=r(65259),l=r(20318);let o=()=>s.A.apiUrl+"/connect/update";class u{static getInstance(e){return(0,a._)(u,u,d)||(0,n._)(u,u,d,new u(e)),(0,a._)(u,u,d)}setOrgId(e){this.orgId=e}on(e,t){this.listener.add(t),"not_connected"===this.status&&this.connect()}off(e){this.listener.remove(e)}setupPing(){setTimeout(()=>{this.socket&&this.socket.readyState===WebSocket.OPEN&&(this.socket.send("{}"),this.setupPing())},3e4)}connect(){if("not_connected"!==this.status)return;this.changeStatus("connecting");let e=[],t=i.A.token();t&&e.push("access_token="+t),this.orgId&&e.push("org_id="+this.orgId);let r=e.length?"?"+e.join("&"):"";this.socket=new WebSocket(o()+r),this.socket.addEventListener("open",()=>{this.changeStatus("connected"),this.setupPing()}),this.socket.addEventListener("close",()=>{this.changeStatus("not_connected"),console.log("WebSocket closed")}),this.socket.addEventListener("message",e=>{try{let t=JSON.parse(e.data);this.listener.trigger(t)}catch(t){console.error("Invalid WebSocket message:",e.data)}})}send(e){this.socket&&this.socket.readyState===WebSocket.OPEN&&this.socket.send(JSON.stringify(e))}disconnect(){if(this.socket)try{this.socket.close()}catch(e){console.error("Error closing WebSocket:",e)}}changeStatus(e){this.status!==e&&(this.status=e)}constructor(e){this.status="not_connected",this.socket=null,this.orgId=e,this.listener=new l.A}}var d={writable:!0,value:null};let c=u},32722:(e,t,r)=>{r.d(t,{_:()=>a});function a(e,t){if(e!==t)throw TypeError("Private static access of wrong provenance")}},35712:(e,t,r)=>{r.d(t,{_:()=>a});function a(e,t){if(void 0===e)throw TypeError("attempted to "+t+" private static field before its declaration")}},42874:(e,t,r)=>{r.d(t,{_:()=>s});var a=r(32722),n=r(35712);function s(e,t,r){return(0,a._)(e,t),(0,n._)(r,"get"),r.get?r.get.call(e):r.value}},70430:(e,t,r)=>{r.d(t,{A:()=>u});var a=r(37876),n=r(14232),s=r(74562),i=r(65259),l=r(43598),o=r(49034);let u=e=>{let{id:t,args:r,setRefetchQuery:o}=e,[u,x]=(0,n.useState)(!1),[f,g]=(0,n.useState)(null),[h,b]=(0,n.useState)([]),p=e=>{let t=h.find(t=>t.id===e.target.id);t&&(t.value=e.target.value),b(h.map(r=>r.id===e.target.id&&null!=t?t:r))},v=async e=>{e.preventDefault();let r=Object.fromEntries(new FormData(e.target));for(let e in r){let t=r[e].toString().trim();if(!t)return;r[e]=t}x(!0);let a=await i.A.doPost({path:"/orgs/".concat(l.A.current().id,"/querysets/").concat(t),data:{data:{args:r}}});if(a.error){g(a.error.message);return}a.data&&(s.A.hide(),o(e=>!e)),x(!1)},w=(0,n.useCallback)(async()=>{let{data:e,error:t}=await i.A.doGet({path:"/orgs/".concat(l.A.current().id,"/aeo/workflows")});if(t){g("Error fetching workflows"),console.log(t.message);return}e&&b(e.workflows.filter(e=>"qgen"===e.type)[0].args.filter(e=>e.used_for.includes("analysis")).map(e=>({...e,value:r[e.id]})))},[r]);return(0,n.useEffect)(()=>{w()},[w]),(0,a.jsxs)("form",{className:"max-h-[60vh] overflow-auto flex flex-col",onSubmit:v,children:[(0,a.jsx)("div",{children:h.length>0&&h.map(e=>"textarea"===e.editor?(0,a.jsx)(c,{id:e.id,name:e.name,value:e.value,description:e.description,required:e.required},e.id):"country_dropdown"===e.editor?(0,a.jsx)(m,{id:e.id,name:e.name,value:e.value,description:e.description,required:e.required},e.id):(0,a.jsx)(d,{id:e.id,name:e.name,value:e.value,changeHandler:p,description:e.description,required:e.required},e.id))}),f&&(0,a.jsx)("div",{className:"text-red-500 font-medium text-base mt-4 mx-1",children:f}),(0,a.jsx)("button",{type:"submit",disabled:u,className:"bgLightBlue text-white font-semibold mt-4 mx-1 py-2 px-4 cursor-pointer rounded-lg hover:bgMediumBlue transition disabled:bg-gray-400 disabled:cursor-not-allowed",children:"Update"})]})},d=e=>{let{id:t,name:r,description:s,required:i,value:l}=e,[o,u]=(0,n.useState)(l);return(0,a.jsxs)("div",{className:"mt-4 flex flex-col mb-1",children:[(0,a.jsx)("label",{className:"text-neutral-500 font-medium text-base mx-1",htmlFor:t,children:r}),(0,a.jsx)("p",{className:"text-neutral-500 font-medium text-xs mx-1",children:s}),(0,a.jsx)("input",{type:"text",id:t,name:t,value:o,onChange:e=>u(e.target.value),required:i,className:"border border-neutral-300 text-neutral-400 font-medium bg-primary max-w-3xl rounded-lg p-3 mt-3 mx-1 focus:ring-1 focus:ring-blue-400 focus:border-blue-400 outline-none transition"})]})},c=e=>{let{id:t,name:r,description:s,required:i,value:l}=e,[o,u]=(0,n.useState)(l);return(0,a.jsxs)("div",{className:"mt-4 flex flex-col mb-1",children:[(0,a.jsx)("label",{className:"text-neutral-500 font-medium text-base mx-1",htmlFor:t,children:r}),(0,a.jsx)("p",{className:"text-neutral-500 font-medium text-xs mx-1",children:s}),(0,a.jsx)("textarea",{id:t,name:t,required:i,value:o,onChange:e=>u(e.target.value),className:"border border-neutral-300 text-neutral-400 font-medium bg-primary max-w-3xl rounded-lg p-3 mt-3 mx-1 focus:ring-1 focus:ring-blue-400 focus:border-blue-400 outline-none transition"})]})},m=e=>{let{id:t,name:r,description:s,required:i,value:l}=e,u=(0,o.oj)(),[d,c]=(0,n.useState)(l);return(0,a.jsxs)("div",{className:"mt-4 flex flex-col mb-1",children:[(0,a.jsx)("label",{className:"text-neutral-500 font-medium text-base mx-1",htmlFor:t,children:r}),(0,a.jsx)("p",{className:"text-neutral-500 font-medium text-xs mx-1",children:s}),(0,a.jsx)("select",{id:t,name:t,required:i,value:d,onChange:e=>c(e.target.value),className:"border border-neutral-300 text-neutral-400 font-medium bg-primary max-w-3xl rounded-lg p-3 mt-3 mx-1 focus:ring-1 focus:ring-blue-400 focus:border-blue-400 outline-none transition",children:Object.values(u).map(e=>(0,a.jsx)("option",{value:e.id,children:e.name},e.id))})]})}},80498:(e,t,r)=>{r.d(t,{_:()=>s});var a=r(32722),n=r(35712);function s(e,t,r,s){return(0,a._)(e,t),(0,n._)(r,"set"),!function(e,t,r){if(t.set)t.set.call(e,r);else{if(!t.writable)throw TypeError("attempted to set read only private field");t.value=r}}(e,r,s),s}},88320:(e,t,r)=>{r.d(t,{A:()=>c});var a=r(37876),n=r(14232),s=r(43598),i=r(65259),l=r(74562),o=r(89099),u=r(49034),d=r(16821);let c=e=>{var t;let{setRefetchTask:r}=e,[u,c]=(0,n.useState)(!1),[g,h]=(0,n.useState)(null),[b,p]=(0,n.useState)([]),[v,w]=(0,n.useState)(""),[j,y]=(0,n.useState)(null),[N,k]=(0,n.useState)(""),[_,S]=(0,n.useState)(""),q=(0,o.useRouter)(),A=s.A.current().id,E=e=>{switch(e){case"website":return v;case"keywords":return(null==j?void 0:j.search_queries.join("\n"))||"";case"user_persona":return(null==j?void 0:j.user_personas.join("\n"))||"";case"brand":return(null==j?void 0:j.brand_names.join(", "))||"";case"location":return(null==j?void 0:j.country_code)||"";case"domains":return(null==j?void 0:j.domains.join(", "))||"";case"num_queries":return(null==j?void 0:j.num_queries.toString())||"";default:return""}},C=async()=>{if(!v){h("Please enter a website");return}h(null),c(!0);let{data:e,error:t}=await i.A.doGet({path:"/orgs/".concat(s.A.current().id,"/aeo/querygen-suggestions?website=").concat(v)});if(t){h("Something went wrong. Please try again."),c(!1);return}e&&S(e.task_id)},P=(0,n.useCallback)(async e=>{let{data:t,error:r}=await i.A.doGet({path:"/orgs/".concat(s.A.current().id,"/aeo/tasks/").concat(e)});if(r){h("Something went wrong"),c(!1);return}if(t){let e=t.task.data.suggestions;k(e.name),y(e),c(!1)}},[]),F=async()=>{let{data:e,error:t}=await i.A.doGet({path:"/orgs/".concat(s.A.current().id,"/aeo/workflows")});if(t){h("Error fetching workflows"),console.log(t.message);return}e&&p(e.workflows.filter(e=>"qgen"===e.type))},O=async e=>{var t;e.preventDefault(),h(null);let r=Object.fromEntries(new FormData(e.target));for(let e in r){let t=r[e].toString().trim();r[e]=t}let a=r.name;if(delete r.name,5>Number(r.num_queries)){h("Number of queries cannot be less than 5");return}if(Number(r.num_queries)>10){h("Number of queries cannot be more than 10 in free tier");return}let n={name:a,data:{workflow:null===(t=b[0])||void 0===t?void 0:t.id,args:r}};c(!0);let o=await i.A.doPost({path:"/orgs/".concat(s.A.current().id,"/querysets"),data:n});if(o.error){h(o.error.message);return}if(o.data){let{id:e}=o.data;if(e){let{data:t,error:r}=await i.A.doPost({path:"/orgs/".concat(s.A.current().id,"/querysets/").concat(e),data:{action:"start_task"}});r&&h(r.message),t&&q.push("/aeo/manage?id=".concat(e))}l.A.hide()}c(!1)};return(0,n.useEffect)(()=>{F()},[]),(0,n.useEffect)(()=>{let e=d.A.getInstance(A),t=e=>{"querygen_helper_task_status"===e.type&&e.data.task_id===_&&("completed"===e.data.status?P(_):"failed"===e.data.status&&h("Task failed"))};return e.on("message",t),()=>{e.off("message",t)}},[A,P,_]),(0,a.jsxs)("form",{className:"max-h-[60vh] overflow-auto flex flex-col",onSubmit:O,children:[(0,a.jsxs)("div",{className:"mt-4 flex flex-col mb-1 ".concat(j?"hidden":""),children:[(0,a.jsx)("label",{className:"text-neutral-500 font-medium text-base mx-1",htmlFor:"name",children:"Enter your business website"}),(0,a.jsx)("p",{className:"text-neutral-500 font-medium text-xs mx-1",children:"Enter the URL of your website"}),(0,a.jsx)("input",{type:"text",id:"website",value:v,onChange:e=>w(e.target.value),required:!0,className:"border border-neutral-300 text-neutral-400 font-medium bg-primary max-w-3xl rounded-lg p-3 mt-3 mx-1 focus:ring-1 focus:ring-blue-400 focus:border-blue-400 outline-none transition"})]}),(0,a.jsxs)("div",{className:"mt-4 flex flex-col mb-1 ".concat(j?"":"hidden"),children:[(0,a.jsx)("label",{className:"text-neutral-500 font-medium text-base mx-1",htmlFor:"name",children:"Question set name"}),(0,a.jsx)("p",{className:"text-neutral-500 font-medium text-xs mx-1",children:"create any name to identify questions set"}),(0,a.jsx)("input",{type:"text",id:"name",name:"name",value:N,onChange:e=>k(e.target.value),required:!0,className:"border border-neutral-300 text-neutral-400 font-medium bg-primary max-w-3xl rounded-lg p-3 mt-3 mx-1 focus:ring-1 focus:ring-blue-400 focus:border-blue-400 outline-none transition"})]}),(0,a.jsx)("div",{className:"".concat(j?"":"hidden"),children:j&&b.length>0&&(null===(t=b[0])||void 0===t?void 0:t.args.map(e=>"textarea"===e.editor?(0,a.jsx)(x,{id:e.id,name:e.name,description:e.description,required:e.required,initialValue:E(e.id)},e.id):"country_dropdown"===e.editor?(0,a.jsx)(f,{id:e.id,name:e.name,description:e.description,required:e.required,initialValue:E(e.id)},e.id):(0,a.jsx)(m,{id:e.id,name:e.name,description:e.description,required:e.required,initialValue:E(e.id)},e.id)))}),g&&(0,a.jsx)("div",{className:"text-red-500 font-medium text-base mt-4 mx-1",children:g}),j&&(0,a.jsx)("button",{type:"submit",disabled:u,className:"bgLightBlue text-white font-semibold mt-4 mx-1 py-2 px-4 cursor-pointer rounded-lg hover:bgMediumBlue transition disabled:bg-gray-400 disabled:cursor-not-allowed",children:"Generate Questions"}),!j&&(0,a.jsx)("button",{type:"button",disabled:u,onClick:()=>C(),className:"bgLightBlue text-white font-semibold mt-4 mx-1 py-2 px-4 cursor-pointer rounded-lg hover:bgMediumBlue transition disabled:bg-gray-400 disabled:cursor-not-allowed",children:u?"Please wait while we are fetching details..":"Next"})]})},m=e=>{let{id:t,name:r,description:s,required:i,initialValue:l}=e,[o,u]=(0,n.useState)(l);return(0,a.jsxs)("div",{className:"mt-4 flex flex-col mb-1",children:[(0,a.jsx)("label",{className:"text-neutral-500 font-medium text-base mx-1",htmlFor:t,children:r}),(0,a.jsx)("p",{className:"text-neutral-500 font-medium text-xs mx-1",children:s}),(0,a.jsx)("input",{type:"text",id:t,name:t,value:o,onChange:e=>u(e.target.value),required:i,readOnly:"website"===t,className:"border border-neutral-300 text-neutral-400 font-medium bg-primary max-w-3xl rounded-lg p-3 mt-3 mx-1 focus:ring-1 focus:ring-blue-400 focus:border-blue-400 outline-none transition"})]})},x=e=>{let{id:t,name:r,description:s,required:i,initialValue:l}=e,[o,u]=(0,n.useState)(l);return(0,a.jsxs)("div",{className:"mt-4 flex flex-col mb-1",children:[(0,a.jsx)("label",{className:"text-neutral-500 font-medium text-base mx-1",htmlFor:t,children:r}),(0,a.jsx)("p",{className:"text-neutral-500 font-medium text-xs mx-1",children:s}),(0,a.jsx)("textarea",{id:t,name:t,value:o,rows:o.split("\n").length,onChange:e=>u(e.target.value),required:i,className:"border border-neutral-300 text-neutral-400 font-medium bg-primary max-w-3xl rounded-lg p-3 mt-3 mx-1 focus:ring-1 focus:ring-blue-400 focus:border-blue-400 outline-none transition"})]})},f=e=>{let{id:t,name:r,description:s,required:i,initialValue:l}=e,o=(0,u.oj)(),[d,c]=(0,n.useState)(l);return(0,a.jsxs)("div",{className:"mt-4 flex flex-col mb-1",children:[(0,a.jsx)("label",{className:"text-neutral-500 font-medium text-base mx-1",htmlFor:t,children:r}),(0,a.jsx)("p",{className:"text-neutral-500 font-medium text-xs mx-1",children:s}),(0,a.jsx)("select",{id:t,name:t,required:i,value:d,onChange:e=>c(e.target.value),className:"border border-neutral-300 text-neutral-400 font-medium bg-primary max-w-3xl rounded-lg p-3 mt-3 mx-1 focus:ring-1 focus:ring-blue-400 focus:border-blue-400 outline-none transition",children:Object.values(o).map(e=>(0,a.jsx)("option",{value:e.id,children:e.name},e.id))})]})}}}]);